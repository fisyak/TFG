#if !defined(__CINT__) || defined(__MAKECINT__)
#include "Riostream.h"
#include <stdio.h>
#include "TROOT.h"
#include "TSystem.h"
#include "TMath.h"
#include "TH1.h"
#include "TH2.h"
#include "TH3.h"
#include "THnSparse.h"
#include "TStyle.h"
#include "TF1.h"
#include "TProfile.h"
#include "TTree.h"
#include "TChain.h"
#include "TFile.h"
#include "TNtuple.h"
#include "TFitResult.h"
#include "TCanvas.h"
#include "TFileSet.h"
#include "TDataSetIter.h"
#include "TDataSet.h"
#include "TClassTable.h"
#include "TMinuit.h"
#include "TSpectrum.h"
#include "StBichsel/Bichsel.h"
#include "StBichsel/StdEdxModel.h"
#include "TString.h"
#include "TLine.h"
#include "TText.h"
#include "TList.h"
#include "TPolyMarker.h"
#include "TKey.h"
#include "TLegend.h"
#endif
struct BP_t {
  //           Hz    ns, sector  row  pad  rdo  fee  fee_ch  max_tb  t0  charge
  Float_t i, freq, tmbk, sector, row, pad, rdo, fee, fee_ch, max_tb, t0, charge;
};
BP_t BP;
void MakeNTupleFromPulser() {
  Float_t freqs[3]  ={ 933e4, 937e4, 940e4}; // Hz 
  const Char_t *Files[3] = {"pulser_933.txt",  "pulser_937.txt",  "pulser_940.txt"};
  TFile *f = new TFile("PulserF2021.root","RECREATE");
  TNtuple *FitP = new TNtuple("FitP","Pulser","i:freq:tmbk:sector:row:pad:rdo:fee:fee_ch:max_tb:t0:charge");
  char line[121];
  Int_t N = 0;
  for (Int_t i = 0; i <3; i++) {
    FILE *fp = fopen(Files[i],"r");
    if (! fp) {
      cout << "Can't open" << Files[i] << endl;
      continue;
    }
    BP.i = i;
    BP.freq = freqs[i];
    BP.tmbk = 1.e9/BP.freq;
    while (fgets(&line[0],120,fp)) {
      if (line[0] == '#') continue;
      Int_t n = sscanf(&line[0],"%f %f %f %f %f %f %f %f %f",&BP.sector,&BP.row,&BP.pad,&BP.rdo,&BP.fee,&BP.fee_ch,&BP.max_tb,&BP.t0,&BP.charge);
      if (n != 8) { // || N%1000 == 0) {
	printf("%s",line);
	printf("%f %f %f %f %f %f %f %f %f %f %f %f\n", BP.i,BP.freq, BP.tmbk,BP.sector,BP.row,BP.pad,BP.rdo,BP.fee,BP.fee_ch,BP.max_tb,BP.t0,BP.charge);
      }
      FitP->Fill(&BP.i);
      N++;
    }
    fclose(fp);
  }
  f->Write();
}
//________________________________________________________________________________
Bool_t GoodPulser(Float_t sector, Float_t row, Float_t t0, Float_t charge) {
  if (row < 1 || row > 72) return kFALSE;
  if (sector < 1 || sector > 24) return kFALSE;
  if (row > 40.5) { // Outer
    if (t0>176&&t0<182&&charge>200) return kTRUE;
  } else { //Inner
    if (t0>183&&t0<187&&charge>1000) return kTRUE;
  }
  return kFALSE;
} 
//________________________________________________________________________________
Float_t CorrectedT0(Float_t sector, Float_t row, Float_t t0) { // 
  Int_t sec = sector - 1;
  if (row <= 40.5) {
    static Double_t corrI[24] = {184.4323,184.4646,184.4494,185.3628,184.4176,184.4547,184.3660,184.3818,184.4308,185.3418,184.4200,184.4316,184.3811,185.3689,184.4212,184.6311,184.5001,184.5057,184.4530,184.4313,184.3983,184.4234,184.4103,185.3207};
    static Double_t corrI2[24] = {-0.0090,-0.0037,-0.0027,-0.0107, 0.0001,-0.0016, 0.0093,-0.0020,-0.0032,-0.0086, 0.0038,-0.0023, 0.0049,-0.0089,-0.0087, 0.0088, 0.0158, 0.0096, 0.0047,-0.0026, 0.0028, 0.0030, 0.0032,-0.0012};
    return t0-corrI[sec] -corrI2[sec];
  } else {
    static Double_t corrO[24] = {178.3912,178.3101,178.2796,178.2620,178.2641,178.3004,178.2859,178.2898,178.2945,178.2688,178.2722,178.2793,178.2958,178.2668,178.2633,178.4995,178.3224,178.3381,178.2646,178.2884,178.2745,178.2770,178.2869,178.2644};
    static Double_t corrO2[24] = {-0.0327,-0.0045,-0.0040,-0.0008, 0.0032,-0.0013,-0.0015, 0.0016,-0.0017, 0.0002, 0.0007,-0.0017,-0.0002, 0.0014, 0.0024, 0.0024, 0.0137, 0.0132, 0.0035, 0.0028, 0.0010, 0.0006,-0.0001, 0.0041};
    return t0-corrO[sec]-corrO2[sec];
  }
}
//________________________________________________________________________________
Float_t CorrectedT0F(Float_t sector, Float_t row, Float_t t0, Float_t freq) { // pulser
  //p0                        =     -151.756   +/-   0.0195952                  = tb0
  //p1                        =  1.62646e-05   +/-   2.09196e-09 => 16.26 musec = time => 300 m
  Float_t t0C = CorrectedT0(sector,row,t0) - (-151.756 + 1.62646e-05*freq);
#if 1 /* 1.96344e-10 +/- 4.53034e-09 sec => pulser signal over cathodes*/
  if (row < 40.5) {
    t0C = freq*(t0C/freq - (-4.18766e-09 + 1.60932e-10*row));
  } else {
    t0C = freq*(t0C/freq - (-7.07266e-09 + 1.20175e-10*row));
  }
#else /* 1.85546e-03 +/- 4.25094e-02 timebuckt @ 933 => 4.55 ns */
  if (row < 40.5) {
    t0C = t0C - (-3.92150e-02 +  1.50720e-03*row);
  } else {
    t0C = t0C - (-6.62786e-02 + 1.12610e-03*row);
  }
#endif
  return t0C;
}
//________________________________________________________________________________
Float_t T0SectroRowCorrection(Float_t sector, Float_t row) {
  //p0                        =     -151.756   +/-   0.0195952                  = tb0
  //p1                        =  1.62646e-05   +/-   2.09196e-09 => 16.26 musec = time => 300 m
  static Double_t corrRS[72][24] = {
    { -2.34,  1.25, -0.46, -0.07,  1.64,  0.94,  5.20,  1.55,  4.77, -0.37,  1.92,  1.06, -4.26,  2.37, -3.72, -2.88,  1.50, -0.69,  0.96, -0.82,  1.36,  0.65,  1.97,  5.85}, // 1
    { -2.84,  0.76, -0.99, -0.54,  1.32,  0.56,  4.64,  0.91,  4.44, -0.76,  1.43,  0.53, -4.96,  2.01, -4.42, -3.14,  1.06, -1.43,  0.32, -1.21,  0.97,  0.27,  1.59,  5.26}, // 2
    {  0.07,  0.63, -4.05, -4.88,  0.37,  2.45,  1.16,  1.64,  4.57,  2.89, -2.90,  3.01, -5.37,  2.55, -6.01,  3.87,  1.84, -1.07, -1.40, -3.57,  3.08,  1.25,  1.80, -1.19}, // 3
    {  0.99,  0.23, -4.77, -5.43, -0.00,  2.09,  0.64,  1.53,  3.86,  2.65, -3.53,  2.83, -5.68,  2.13, -6.23,  3.53,  1.48, -1.25, -1.69, -3.97,  2.88,  0.89,  1.41, -1.58}, // 4
    { -4.31, -2.19, -0.15, -3.39, -2.39,  1.06,  2.80,  0.11, -3.70, -0.71,  0.71,  0.92, -0.45,  0.76, -0.79,  0.55,  2.85,  0.98,  0.60,  1.52, -1.23,  4.14,  1.59,  2.44}, // 5
    { -5.71, -2.54, -0.59, -3.29, -2.51,  0.36,  2.68, -0.83, -4.44, -1.39,  0.83,  0.65, -0.04,  0.79, -0.61,  0.32,  2.85,  0.64,  0.07,  1.64, -1.82,  4.16,  1.05,  2.46}, // 6
    { -7.94, -1.02, -0.74, -0.26,  0.04,  0.12,  2.92, -1.39, -3.57, -2.90,  3.65,  0.52,  0.67,  0.82,  1.52,  2.04,  4.42,  0.90, -0.59,  3.69, -0.69,  4.97,  0.15,  2.06}, // 7
    { -7.75, -1.41, -0.46, -0.55, -0.18, -0.03,  1.50, -0.15, -3.94, -3.19,  3.70, -0.97, -0.96, -0.67,  2.43,  0.93,  3.19,  0.63, -0.94,  2.78, -0.54,  3.82, -0.36,  0.56}, // 8
    { -3.40, -5.59,  1.93,  0.54,  0.54, -2.15, -3.60,  5.50,  1.13, -6.93,  2.39, -1.34, -3.56, -2.89,  7.80,  0.83, -1.83, -1.19, -2.02,  0.26,  3.57, -0.79, -0.11, -2.98}, // 9
    { -3.37, -6.65,  1.02,  0.04, -0.19, -2.85, -4.02,  4.82,  0.98, -7.62,  1.69, -0.70, -3.76, -2.53,  7.35,  1.07, -2.34, -1.90, -2.26, -0.21,  3.45, -1.47, -0.55, -3.12}, // 10
    {  1.56, -1.94, -1.35,  4.38,  2.29, -1.87,  1.69,  1.15, -1.45, -7.71,  1.93, -0.33, -2.02,  2.54,  2.97,  3.10, -0.54,  0.34,  3.62,  1.49,  4.29,  2.34, -0.11,  2.63}, // 11
    {  1.09, -2.12, -1.50,  4.10,  1.68, -2.06,  1.49,  0.92, -2.70, -7.92,  1.80, -0.48, -2.87,  2.85,  2.64,  1.89, -0.90,  0.08,  3.14,  0.88,  4.49,  1.86, -0.79,  2.26}, // 12
    {  3.12,  2.02, -1.97, -0.72, -2.24, -0.55, -1.66, -2.14, -2.78,  1.01, -3.67,  2.44,  1.83,  3.56, -0.77,  0.78,  1.22,  1.93, -3.16,  1.70,  6.51,  0.94, -1.21,  0.32}, // 13
    {  2.52,  1.79, -2.75, -1.79, -2.58, -0.61, -3.15, -2.94, -2.65,  1.75, -5.31,  2.24,  2.27,  2.79, -1.61,  0.99,  1.10,  1.45, -4.68,  1.63,  6.12,  0.25, -1.21, -0.38}, // 14
    { -0.73,  2.50,  0.22,  0.02, -1.54, -1.75,  1.20, -4.36,  1.40,  3.31, -1.05,  2.01,  3.51, -0.27,  0.05, -6.05,  0.37, -0.65, -1.07,  1.65, -3.15, -0.12, -0.10,  0.59}, // 15
    { -0.78,  1.43, -0.90, -0.00, -1.75, -2.69,  2.07, -5.23,  1.93,  2.94, -0.38, -0.13,  2.20, -1.46,  0.77, -6.98, -0.36, -1.52, -0.44,  1.29, -4.40, -0.34, -1.06, -0.70}, // 16
    {  3.42, -2.49, -2.84, -2.01, -0.87, -3.19,  4.48, -3.71,  2.02,  3.53, -1.58, -4.77, -1.79, -4.63,  0.71, -3.78, -3.45, -2.25,  0.32,  1.63, -1.91, -1.59, -2.02, -3.70}, // 17
    {  3.52, -2.68, -1.79, -3.10, -1.81, -3.04,  4.62, -2.62,  0.74,  1.93, -2.15, -4.14, -1.42, -5.38, -0.29, -4.07, -3.90, -2.58, -1.05,  1.83, -2.48, -2.12, -2.12, -3.15}, // 18
    { -2.76,  0.48,  4.17, -2.23, -3.25, -0.96, -1.30, -0.17,  1.01, -3.22,  0.17, -0.29,  2.70, -5.02, -3.64,  1.03, -3.38, -0.89, -0.82,  0.80,  0.00, -2.16, -0.45, -2.07}, // 19
    { -3.75,  0.51,  3.27, -1.42, -4.83, -2.40, -1.51,  0.50,  1.40, -3.22,  0.75, -0.33,  4.07, -3.15, -2.81,  0.06, -4.79, -1.70, -0.16, -0.84, -1.37, -3.75, -2.73, -3.04}, // 20
    { -0.92,  1.44,  0.86, -0.42, -1.40, -0.54,  1.12,  5.11,  3.10, -0.39,  0.87,  0.69,  2.30,  2.00, -2.56,  0.53, -2.23,  0.03,  0.33, -0.01, -3.85, -2.18, -0.96, -0.50}, // 21
    { -2.57,  1.34,  0.57, -0.32, -2.31, -0.39,  1.01,  4.21,  3.31, -1.61,  1.38,  0.08,  2.64,  0.71, -2.77, -0.09, -2.81,  0.15, -0.46, -1.11, -2.34, -2.46, -1.24, -1.23}, // 22
    {  4.17,  1.29,  0.45,  0.60, -0.04, -0.68,  3.58,  4.78, -0.43,  0.97,  0.50,  2.56,  2.08,  1.25, -2.52,  0.33,  0.86,  0.74,  2.93, -1.85,  0.21, -0.21,  0.32,  2.62}, // 23
    {  4.69,  0.54, -0.30, -0.36,  1.66, -0.74,  2.32,  4.83, -0.78,  0.78, -1.64,  2.97, -0.04,  0.57, -3.85,  1.33,  2.38,  0.73,  3.08, -1.49, -0.60, -0.35,  1.43,  3.44}, // 24
    {  3.28,  0.72,  3.43,  2.02,  0.89, -1.02,  4.31, -2.82,  2.41,  3.08, -2.53,  3.07,  0.62,  3.46,  3.20,  0.37,  1.90,  2.60,  3.41, -0.57,  0.01,  0.31, -0.99,  1.27}, // 25
    {  3.07,  0.18,  2.19,  1.18,  0.08, -1.40,  3.11, -2.45,  0.80,  2.52, -1.65,  2.83, -0.50,  2.10,  2.75, -0.85,  1.25,  1.28,  2.75, -1.51,  0.84,  0.29, -1.61,  1.16}, // 26
    {  0.88,  2.58,  1.48,  0.91,  1.27,  0.94,  6.26, -0.67,  4.03, -1.69,  3.54,  0.64,  2.89,  3.93, -3.21, -0.60,  0.82,  1.81,  2.03, -3.66, -2.02, -0.84, -0.20, -0.65}, // 27
    {  0.69,  1.61,  1.33,  1.59,  1.16,  0.41,  6.02, -2.92,  3.68, -0.36,  1.16,  0.26,  2.26,  4.65, -2.15,  0.39,  0.37,  2.07,  1.91, -2.75, -2.86, -1.11, -1.05, -0.08}, // 28
    {  0.41,  1.02, -1.00,  2.45,  1.69,  1.59,  3.36,  1.06,  1.61, -1.90,  2.52,  2.06,  0.60, -1.67,  0.54, -0.50, -0.32, -0.30,  0.62,  0.09,  1.42, -1.23, -0.47, -1.39}, // 29
    { -0.18,  1.89, -0.86,  1.78,  1.33,  1.20,  4.98,  0.67,  1.34, -2.55,  2.84,  0.67,  0.90, -0.25, -1.47, -1.77, -0.47, -0.34,  0.09, -1.97, -0.14, -0.93, -0.92, -1.77}, // 30
    {  0.48,  0.70,  1.28,  2.66,  1.35,  3.82, -1.54,  0.28, -0.73,  1.06,  1.71, -0.94, -0.08, -3.02,  4.47,  2.10, -1.14,  1.51,  1.15,  2.70, -1.50, -3.24,  1.29, -1.56}, // 31
    {  0.87,  0.22,  0.26,  2.12,  0.88,  2.87, -2.45,  0.64,  0.49, -0.25,  1.77, -0.10, -0.07, -4.70,  3.62,  1.78, -1.62,  0.71,  0.89,  2.71, -0.90, -4.36,  0.65, -2.58}, // 32
    {  1.04,  0.12,  1.77,  2.41,  1.94, -0.90, -2.24, -0.85,  1.94,  0.95, -0.83, -1.19,  2.87, -2.82,  5.13,  2.53, -0.55,  2.17, -1.87,  1.18, -2.22, -3.08, -2.31,  4.24}, // 33
    {  0.29, -0.34,  1.56,  2.07,  1.32, -0.29, -2.52, -1.78, -0.36,  0.81, -1.48, -2.39,  1.31, -2.63,  4.52,  1.83, -0.89,  1.87, -2.01,  0.47, -3.75, -3.40, -1.43,  3.63}, // 34
    {  2.93, -0.09, -1.13,  0.16,  1.42,  0.15, -2.95, -0.83, -0.46,  2.27, -5.13,  2.30,  0.09,  0.98,  1.01, -3.41,  0.26, -3.06, -0.92,  4.88, -0.86,  2.83, -0.32,  3.00}, // 35
    {  1.97, -0.77, -1.68,  0.19,  0.72, -0.48, -3.45, -1.31, -0.50,  1.83, -5.06,  1.42,  0.11,  0.01,  1.15, -2.99, -0.23, -3.35, -1.61,  3.91, -1.03,  1.91, -1.09,  2.71}, // 36
    {  0.92, -0.53, -1.63, -0.30, -0.86,  1.05, -4.66, -1.12, -1.65,  3.30,  0.14, -1.44, -0.16, -0.30, -0.26,  0.88,  0.46, -1.33, -1.89,  1.66,  1.08,  0.50,  1.15, -2.38}, // 37
    {  0.85, -0.97, -2.15, -0.83, -1.10,  0.44, -5.29, -1.46, -2.22,  2.95, -0.98, -1.52, -0.58, -0.54, -0.71, -0.02, -0.07, -1.94, -2.15,  1.49,  0.67,  0.79,  0.38, -2.59}, // 38
    {  1.42, -1.41, -2.04, -2.41, -1.49,  1.20, -5.66, -0.60, -2.46,  5.00,  1.04, -1.77, -0.15, -0.23, -1.87,  2.16,  0.97, -1.38, -1.13,  0.59,  1.03,  0.36,  1.44, -3.34}, // 39
    { -5.80,  2.64,  4.93, -1.94,  3.86,  5.03,-10.11,  2.95,-10.02,  0.00,  3.40, -7.27, -5.72,  3.43, -4.43,  1.56,  3.76,  4.78,  2.58,-14.39,  3.77,  8.36,  8.45, -1.21}, // 40
    { -3.49,  0.80, -0.41,  0.83,  3.33,  0.01,  0.78,  0.28,  0.92,  2.54,  1.36,  0.49,  2.71,  0.36,  0.68,  1.94, -1.12, -0.48,  0.79,  1.55,  0.94,  1.17,  2.53, -0.71}, // 41
    { -4.00,  0.11, -0.94,  0.10,  2.45, -0.76,  0.42, -0.42,  0.64,  1.90,  0.66, -0.19,  2.23, -0.22,  0.10,  1.48, -1.76, -0.78,  0.17,  0.84,  0.14,  0.47,  2.00, -1.27}, // 42
    { -2.56, -0.68, -1.65,  0.46,  2.26, -1.81,  0.25,  3.68, -0.63,  4.24, -1.35,  0.09,  2.24,  2.05,  1.53,  0.34, -0.97,  2.92,  1.54,  1.33,  1.35,  2.30,  2.16, -0.56}, // 43
    { -2.79, -1.03, -2.10,  0.33,  1.77, -2.14,  0.04,  3.55, -0.92,  3.88, -1.96, -0.06,  1.80,  1.54,  1.11, -0.02, -1.48,  2.41,  1.12,  0.90,  1.05,  1.75,  1.72, -0.74}, // 44
    { -5.68, -1.41, -3.47,  0.53,  1.32, -2.25, -0.09,  3.91, -1.38,  2.78, -2.26, -1.06,  1.46, -0.64, -1.90, -0.03, -1.33,  1.06, -0.49,  0.21, -1.46, -0.56, -0.04, -2.26}, // 45
    { -6.14, -1.85, -4.09, -0.13,  0.78, -2.69, -0.83,  3.40, -1.96,  2.22, -2.65, -1.57,  1.02, -1.20, -2.03, -0.32, -1.66,  0.65, -1.01, -0.34, -1.79, -1.19, -0.35, -2.92}, // 46
    { -4.60, -0.92, -2.92,  0.82,  1.56,  0.49, -0.08, -2.69, -2.68,  0.07, -3.30,  0.87,  1.35, -1.42,  0.20,  0.54, -1.44, -2.57,  0.15, -0.86, -1.70, -0.69, -0.80, -0.93}, // 47
    { -5.18, -0.90, -3.52,  0.70,  1.21,  0.22, -0.45, -2.97, -2.88, -0.25, -3.53,  0.46,  1.06, -1.71, -0.42,  0.37, -1.96, -2.90, -0.16, -1.10, -1.97, -0.89, -1.10, -1.22}, // 48
    { -2.32, -0.23, -3.04,  3.25,  2.52,  1.96,  0.59, -0.60, -1.34,  0.84,  2.59,  3.59,  1.52, -0.44,  0.97,  0.01, -0.09, -2.27,  1.17,  0.69, -1.53,  0.98,  0.51,  0.01}, // 49
    { -2.44, -0.64, -3.29,  2.76,  1.85,  1.42,  0.20, -0.86, -1.63,  0.29,  2.08,  2.95,  1.07, -0.77,  0.68, -0.08, -0.70, -2.73,  0.55, -0.10, -1.95,  0.29, -0.06, -0.60}, // 50
    { -1.38, -0.45, -0.67, -0.01,  2.96,  1.52,  1.08,  0.64, -0.48, -0.29,  2.80,  4.33,  1.69, -1.31,  1.44,  1.50,  1.27,  0.25,  1.01,  0.56, -1.60,  1.39,  1.09,  1.25}, // 51
    { -1.33, -0.87, -0.77, -0.17,  2.34,  1.00,  0.85,  0.18, -1.00, -0.73,  2.09,  3.76,  1.28, -1.63,  0.78,  0.95,  0.88, -0.23,  0.44,  0.03, -2.00,  0.85,  0.29,  0.62}, // 52
    { -3.15, -1.54, -0.30, -1.45,  0.80, -0.84, -1.09,  0.57,  2.82, -2.20, -0.80,  1.00, -0.86, -2.10,  0.06, -1.38,  0.02, -0.61, -0.02, -1.04,  0.68, -0.64, -2.02, -1.07}, // 53
    { -3.18, -2.13, -0.60, -1.77,  0.19, -1.23, -1.73, -0.10,  2.28, -2.83, -1.30,  0.52, -1.36, -2.52, -0.43, -1.79, -0.36, -1.01, -0.54, -1.51,  0.15, -1.28, -2.26, -1.61}, // 54
    { -0.85, -0.55, -0.02, -0.14,  1.31,  1.33, -0.86,  1.73,  3.00, -2.68,  0.40,  1.75,  0.39, -0.11,  0.15, -0.60, -0.14, -0.50, -0.83, -0.59,  1.66, -0.28, -1.42, -0.93}, // 55
    { -0.46, -1.09, -0.02, -0.47,  0.83,  1.09, -1.11,  1.28,  2.69, -2.76,  0.10,  1.48,  0.25, -0.62, -0.11, -0.98, -0.32, -1.04, -1.25, -0.80,  1.33, -0.62, -1.76, -1.26}, // 56
    {  1.80,  0.12,  0.37,  0.05,  0.17,  0.70, -0.14, -0.52,  3.40,  1.41, -1.02,  2.78, -1.68,  2.19, -0.67, -0.16,  1.23,  1.72, -0.10,  0.61,  1.33,  0.15,  0.33, -0.27}, // 57
    {  1.83, -0.09,  0.35, -0.25, -0.14,  0.44, -0.31, -0.85,  3.08,  0.94, -1.27,  2.38, -1.97,  1.78, -1.02, -0.56,  0.83,  1.53, -0.16,  0.20,  1.10, -0.48,  0.19, -0.68}, // 58
    {  1.93,  0.77,  1.92,  0.28,  2.96,  1.51,  2.25, -0.97,  2.82,  0.41, -1.01, -0.77, -1.29,  2.55,  0.58,  2.50,  0.22,  1.63, -0.31,  0.72, -0.07,  1.04,  2.40,  3.04}, // 59
    {  2.04,  0.33,  1.97, -0.10,  2.42,  1.14,  1.91, -1.14,  2.22,  0.21, -1.36, -1.21, -1.86,  2.13,  0.04,  2.07, -0.17,  1.12, -0.71,  0.27, -0.74,  0.70,  1.96,  2.52}, // 60
    {  1.85,  0.59,  0.98, -2.13, -0.99,  0.18, -1.48, -3.15, -0.87, -0.82, -1.74, -1.84, -1.44,  1.68, -0.64, -1.53, -0.18, -1.91, -1.22,  0.26, -0.77, -0.74,  0.28,  0.68}, // 61
    {  1.91,  0.19,  0.98, -2.57, -1.56, -0.08, -2.27, -3.56, -1.30, -1.11, -2.13, -2.21, -1.82,  1.22, -0.94, -1.94, -0.54, -2.34, -1.69, -0.38, -1.10, -1.18,  0.02,  0.29}, // 62
    {  2.42,  1.04,  2.14, -0.16, -1.09,  1.25, -0.23, -2.34, -1.80,  0.76,  1.01, -2.08, -0.62,  0.89, -1.13, -0.99,  1.88, -0.98,  0.08, -0.55,  1.67, -1.23, -0.20,  1.39}, // 63
    {  2.08,  0.38,  1.57, -0.89, -1.48,  0.51, -0.66, -2.76, -2.13,  0.17,  0.46, -2.35, -1.13,  0.59, -1.90, -1.45,  1.25, -1.71, -0.48, -0.97,  1.09, -1.58, -0.52,  0.90}, // 64
    {  3.93,  2.17,  3.60,  0.29, -5.06, -0.39,  1.09, -0.80,  1.31, -0.36,  1.94, -0.16,  1.05,  2.36,  0.89,  0.67,  0.31,  0.09,  1.41,  1.70,  0.15,  0.63,  0.54,  1.41}, // 65
    {  3.36,  1.82,  3.10, -0.31, -1.91, -0.72,  0.55, -1.52,  0.78, -0.97,  1.46, -0.84,  0.64,  1.75,  0.36,  0.01, -0.13, -0.43,  0.70,  1.27, -0.37,  0.11, -0.04,  0.82}, // 66
    {  4.10,  2.75,  3.57,  1.24, -2.44,  0.79,  1.23,  1.26,  0.47,  0.47,  2.94, -0.50, -0.14,  1.26,  2.07,  1.71,  2.06,  3.05,  1.18,  0.65,  1.73,  1.05,  0.73,  2.45}, // 67
    {  3.62,  2.26,  3.00,  0.97, -0.63,  0.48,  1.05,  1.12, -0.08,  0.04,  2.73, -0.56, -0.54,  1.00,  1.76,  1.21,  1.63,  2.52,  0.99,  0.35,  1.67,  0.60,  0.23,  2.35}, // 68
    {  1.83, -0.44, -0.03, -0.61, -2.30, -0.35, -0.20,  0.65, -1.72, -0.62,  0.04, -1.60, -0.91, -1.59, -1.01, -0.74, -0.41,  0.87,  0.36, -0.99, -0.51, -1.39, -1.27, -1.01}, // 69
    {  1.50, -1.02, -0.51, -1.24, -2.93, -0.71, -0.64,  0.00, -1.78, -1.16, -0.42, -2.27, -1.52, -2.13, -1.44, -1.08, -1.10,  0.39, -0.38, -1.37, -1.19, -1.75, -1.40, -1.71}, // 70
    {  2.54,  0.19, -0.31,  0.71, -2.73, -1.30,  0.07,  2.64, -0.68, -1.24,  0.84, -1.79, -0.30, -2.51,  0.28, -0.28,  0.98,  0.70, -0.67, -0.12,  0.67,  1.19, -0.69, -0.10}, // 71
    {  2.47, -0.05, -0.56,  0.41, -3.17, -1.42, -0.26,  2.12, -1.48, -1.64,  0.39, -2.01, -0.50, -2.74,  0.13, -0.51,  0.64,  0.37, -1.09, -0.64,  0.64,  0.90, -1.32, -0.55}  // 72
  };
  Int_t s = sector - 1;
  Int_t r = row - 1;
  return corrRS[r][s];
}
//________________________________________________________________________________
Float_t CorrectedT0F2(Float_t sector, Float_t row, Float_t t0, Float_t freq) {// pulser correction
  //p0                        =     -151.756   +/-   0.0195952                  = tb0
  //p1                        =  1.62646e-05   +/-   2.09196e-09 => 16.26 musec = time => 300 m
  Float_t t0C = CorrectedT0F(sector,row,t0,freq);
  t0C -= 1e-9*freq*T0SectroRowCorrection(sector,row);
  return t0C;
}
//________________________________________________________________________________
Float_t CorrectedT0H(Float_t sector, Float_t row, Float_t t0, Float_t freq) {// "prompt" hits correction
  //p0                        =     -151.756   +/-   0.0195952                  = tb0
  //p1                        =  1.62646e-05   +/-   2.09196e-09 => 16.26 musec = time => 300 m
  Float_t t0C = CorrectedT0(sector,row,t0);
  t0C -= 1e-9*freq*T0SectroRowCorrection(sector,row);
  return t0C;
}
