//________________________________________________________________________________
Double_t Girrf(Double_t poverm, Int_t k = 0) {
  //        returns value of relative ionisation normalised to value
  //        at p/m=4 poverm    p/m (=beta gamma)             (input)
  //        k = 0/1 (default) pi+/-,K+/-,P/pbar, deuteron, ..
  //        k = 2   e+
  //        k = 3   e-
  Double_t par[3][8] = {
    {1.73553e+00,  6.37205e-01, -2.83910e-01,  1.37318e-01,  
     6.24651e-02, -6.89529e-02,  1.83442e-02, -1.58792e-03},// pbar
    {1.53185e+00,  7.12521e-01,  1.08820e-02,  8.23682e-02, 
    -1.44492e-01,  7.37149e-02, -1.67665e-02,  1.43531e-03},// e+
    {1.51295e+00,  9.14499e-01, -5.50513e-02, -8.04242e-02, 
    -1.29549e-02,  3.82555e-02, -1.35265e-02,  1.43929e-03} // e-
  };
  Double_t parG[10] = {
    -9.51524e-01,  1.62233e+00, -2.03613e+00,  1.40230e+00, -4.77226e-01,
     6.16030e-02,  8.66171e-01, -2.35670e-02,  3.20828e-02,  0.00000e+00
  };    
  Double_t beta2inv = 1. + 1./(poverm*poverm);
  Double_t x = TMath::Log10 (poverm);
  Int_t l = 0;
  if (k == 6) l = 1; // e+
  if (k == 2) l = 2; // e-
  Double_t sirrf = par[l][0];
  Double_t xx[8];
  xx[0] = 1; 
  Int_t i;
  for (i=1; i<8; i++) {xx[i] = x*xx[i-1]; sirrf += par[l][i]*xx[i];}
  Double_t corr = parG[0];
  for (i=1; i<6; i++) corr += xx[i]*parG[i];
  Double_t bL = TMath::Log(beta2inv);
  corr += bL*(parG[6] + bL*(parG[7] + bL*parG[8])); 
  return TMath::Log10(sirrf*beta2inv*TMath::Exp(corr)*1.6620E-03);
}
//________________________________________________________________________________
Double_t sifunc(Double_t *x,Double_t *par) {
  Double_t pove   = pow(10.,x[0]);
  Int_t    k      = par[1];
  return Girrf(pove,k);
}
//________________________________________________________________________________
void star(){
  gROOT->Reset();
  const Int_t N = 100;
  const Double_t bgLMin = -1;
  const Double_t bgLMax =  4;
  //      Mixture   p10   Dens=0.9*0.00166+0.1*0.000667    " g/cm**3 "
  Double_t densAr = 1.6620E-03; // g/cm3 
  Double_t densCH4 = 6.6715E-04;// g/cm3
  Double_t densP10  = 0.9*0.00166+0.1*0.000667;
  Double_t CLoss[2][2][N] = {
{// proton in Argon
  5.392E+01,  4.548E+01,  3.827E+01,  3.213E+01,  2.693E+01,
  2.254E+01,  1.885E+01,  1.575E+01,  1.317E+01,  1.102E+01,
  9.233E+00,  7.757E+00,  6.540E+00,  5.540E+00,  4.721E+00,
  4.052E+00,  3.508E+00,  3.067E+00,  2.711E+00,  2.426E+00,
  2.198E+00,  2.018E+00,  1.877E+00,  1.768E+00,  1.685E+00,
  1.623E+00,  1.579E+00,  1.549E+00,  1.531E+00,  1.522E+00,
  1.521E+00,  1.526E+00,  1.536E+00,  1.551E+00,  1.568E+00,
  1.589E+00,  1.612E+00,  1.636E+00,  1.662E+00,  1.689E+00,
  1.717E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,
  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00,  1.743E+00},
{ // proton in CH4
  1.054E+02,  8.736E+01,  7.233E+01,  5.983E+01,  4.946E+01,
  4.087E+01,  3.377E+01,  2.792E+01,  2.312E+01,  1.917E+01,
  1.593E+01,  1.329E+01,  1.113E+01,  9.372E+00,  7.942E+00,
  6.783E+00,  5.845E+00,  5.088E+00,  4.481E+00,  3.994E+00,
  3.606E+00,  3.300E+00,  3.059E+00,  2.872E+00,  2.728E+00,
  2.620E+00,  2.541E+00,  2.486E+00,  2.449E+00,  2.428E+00,
  2.419E+00,  2.421E+00,  2.431E+00,  2.447E+00,  2.469E+00,
  2.495E+00,  2.525E+00,  2.557E+00,  2.592E+00,  2.629E+00,
  2.667E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,
  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00,  2.702E+00}	
{// e in Argon
   3.852E+01,   3.317E+01,   2.841E+01,   2.422E+01,   2.058E+01,
   1.743E+01,   1.474E+01,   1.245E+01,   1.051E+01,   8.869E+00,
   7.497E+00,   6.351E+00,   5.397E+00,   4.608E+00,   3.956E+00,
   3.421E+00,   2.983E+00,   2.626E+00,   2.337E+00,   2.105E+00,
   1.920E+00,   1.773E+00,   1.658E+00,   1.569E+00,   1.502E+00,
   1.453E+00,   1.418E+00,   1.394E+00,   1.381E+00,   1.375E+00,
   1.375E+00,   1.381E+00,   1.390E+00,   1.403E+00,   1.418E+00,
   1.435E+00,   1.454E+00,   1.474E+00,   1.495E+00,   1.517E+00,
   1.540E+00,   1.563E+00,   1.587E+00,   1.610E+00,   1.634E+00,
   1.658E+00,   1.683E+00,   1.707E+00,   1.731E+00,   1.756E+00,
   1.780E+00,   1.804E+00,   1.829E+00,   1.853E+00,   1.878E+00,
   1.902E+00,   1.925E+00,   1.947E+00,   1.969E+00,   1.989E+00,
   2.009E+00,   2.028E+00,   2.047E+00,   2.065E+00,   2.083E+00,
   2.101E+00,   2.118E+00,   2.135E+00,   2.152E+00,   2.169E+00,
   2.185E+00,   2.201E+00,   2.217E+00,   2.232E+00,   2.247E+00,
   2.262E+00,   2.276E+00,   2.289E+00,   2.302E+00,   2.315E+00,
   2.327E+00,   2.338E+00,   2.350E+00,   2.361E+00,   2.371E+00,
   2.382E+00,   2.392E+00,   2.402E+00,   2.413E+00,   2.422E+00,
   2.432E+00,   2.442E+00,   2.452E+00,   2.461E+00,   2.470E+00,
   2.480E+00,   2.489E+00,   2.498E+00,   2.506E+00,   2.515E+00},
{//e in CH4
   3.279E+00,   3.006E+00,   2.791E+00,   2.624E+00,   2.496E+00,
   2.400E+00,   2.329E+00,   2.279E+00,   2.246E+00,   2.227E+00,
   2.218E+00,   2.218E+00,   2.226E+00,   2.239E+00,   2.256E+00,
   2.277E+00,   2.301E+00,   2.327E+00,   2.355E+00,   2.385E+00,
   2.415E+00,   2.446E+00,   2.478E+00,   2.511E+00,   2.544E+00,
   2.577E+00,   2.610E+00,   2.643E+00,   2.677E+00,   2.710E+00,
   2.744E+00,   2.778E+00,   2.812E+00,   2.844E+00,   2.873E+00,
   2.900E+00,   2.925E+00,   2.947E+00,   2.969E+00,   2.989E+00,
   3.008E+00,   3.026E+00,   3.044E+00,   3.062E+00,   3.079E+00,
   3.095E+00,   3.112E+00,   3.128E+00,   3.144E+00,   3.159E+00,
   3.175E+00,   3.190E+00,   3.205E+00,   3.220E+00,   3.235E+00,
   3.249E+00,   3.264E+00,   3.277E+00,   3.291E+00,   3.304E+00,
   3.317E+00,   3.330E+00,   3.343E+00,   3.355E+00,   3.367E+00,
   3.379E+00,   3.391E+00,   3.402E+00,   3.414E+00,   3.425E+00,
   3.437E+00,   3.448E+00,   3.460E+00,   3.471E+00,   3.482E+00,
   3.493E+00,   3.505E+00,   3.516E+00,   3.527E+00,   3.538E+00,
   3.549E+00,   3.560E+00,   3.572E+00,   3.583E+00,   3.594E+00,
   3.605E+00,   3.616E+00,   3.627E+00,   3.638E+00,   3.649E+00,
   3.661E+00,   3.672E+00,   3.683E+00,   3.694E+00,   3.705E+00,
   3.716E+00,   3.727E+00,   3.739E+00,   3.750E+00,   3.761E+00}
  };
   c1 = new TCanvas("c1","",200,10,700,500);

   c1->SetFillColor(42);
   c1->SetGrid();

Double_t x[N], y[N];
Double_t dbg = (bgLMax - bgLMin)/(N-1);
for (int l = 0; l<2; l++) { // p/e
  //  for (int k = 0; k<2; k++) { // Ar/CH4
  Int_t n = 0;
   for (Int_t i=0;i<N;i++) {
     //     double b = pow(10., bgLMin + dbg*i);
     //     x[i] = b;
     Double_t xx = bgLMin + dbg*i;
     if (xx < 0) continue;
     x[n] = xx;
     Double_t closs = (0.9*0.001668*CLoss[l][0][i] + 0.1*0.000667*CLoss[l][1][i]);///densP10;
     //     y[i] = TMath::Log10(CLoss[k][l][i]);
     //     y[i] = TMath::Log10(closs);
     y[n] = closs;
     n++;
   }
   Int_t color = l + 2;
   gr = new TGraph(n,x,y);
   gr->SetFillColor(color);
   gr->SetLineColor(color);
   gr->SetLineWidth(4);
   gr->SetMarkerColor(color);
   gr->SetMarkerStyle(21);
   gr->SetTitle("a simple graph");
   if (l == 0)gr->Draw("ACP");
   else                  gr->Draw("CP");
   //  }
}
c1->Modified();
#if 0
  TF1 *sie = new TF1("sie",sifunc,-.4,4.0,2);
  sie->SetParameter(0,0.51099907e-3);
  sie->SetParameter(1,2);
  sie->SetLineColor(2);
  TF1 *sip = new TF1("si",sifunc,-.4,4.0,2);
  sip->SetParameter(0,0.93827231);
  sip->SetParameter(1,0);
  sip->SetLineColor(3);
  sie->Draw("same");
  sip->Draw("same");
 TCanvas *c2 = new TCanvas();
  sie->Draw();
  sip->Draw("same");
#endif
}
