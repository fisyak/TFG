//
struct Run_t {
  Int_t day;   Float_t dx,  ddx,     dy,  ddy,     dz,  ddz,  alpha,dalpha,  beta,dbeta,  gamma,dgamma; 
  Int_t    run,     date,  time; Float_t    zdc;
};
//  day,     dx,  ddx,     dy,  ddy,     dz,  ddz,  alpha,dalpha,  beta,dbeta,  gamma,dgamma     run,     date,  time,    zdc
Run_t Run[] = {
  { 20, 163.93,14.68, 186.40, 1.24,-325.13,12.82,  -0.43, 0.01,  -0.01, 0.00,  -0.39, 0.06, 6020062, 20050120,101458, 9965.6, "CuCu200RF"},
  { 21,  36.89, 3.34, 223.35, 2.26,-331.49,23.54,  -0.22, 0.00,  -0.04, 0.01,  -0.38, 0.10, 6021012, 20050121,103145,  714.4, "CuCu200RF"},
  { 25, 317.98, 5.08, 443.98, 5.18,-323.08, 4.45,  -0.47, 0.01,  -0.08, 0.01,  -0.35, 0.02, 6025041, 20050125, 91811, 4633.9, "CuCu200RF"},
  { 32, 125.45,13.71, 335.51,14.03,-322.33,11.92,  -0.27, 0.01,  -0.05, 0.00,  -0.18, 0.05, 6032011, 20050201, 75822,23801.3, "CuCu200RF"},
  { 34, 162.66, 8.97, 295.76, 9.20,-345.65, 7.83,  -0.48, 0.01,  -0.06, 0.00,  -0.28, 0.03, 6034014, 20050202, 54736, 6222.1, "CuCu200RF"},//<No turn off 
  { 44,  13.42, 6.80, 116.51, 0.57,-279.59, 5.88,  -0.49, 0.02,  -0.11, 0.01,  -0.31, 0.03, 6044001, 20050213, 53235, 7831.2, "CuCu200RF"},//Magnet between these runs
  { 45, 219.62,14.98, 533.72,15.17,-276.52,12.96,  -0.29, 0.00,  -0.12, 0.01,  -0.49, 0.06, 6045082, 20050213,152450, 8504.7, "CuCu200RF"},
  { 48,-709.95, 5.70,-785.77, 5.78,  12.55, 1.63,  -0.07, 0.02,   0.11, 0.01,   0.29, 0.02, 6048024, 20050217,  5609, 7511.3, "CuCu200FF"},
  { 49,-117.92, 0.93,-202.97, 9.92,   6.43, 2.13,  -0.01, 0.00,   0.02, 0.00,  -0.01, 0.03, 6049129, 20050218, 75627, 6319.5, "CuCu200FF"},
  { 51,-464.59,12.05,-533.79,11.81,  24.72, 3.22,  -0.04, 0.00,  -0.00, 0.01,   0.19, 0.04, 6051055, 20050220,193744,10248.1, "CuCu200FF"},
  { 57,-244.74, 4.62,-315.28, 4.47,  14.36, 1.04,  -0.04, 0.02,  -0.02, 0.00,   0.05, 0.02, 6057048, 20050221,052710, 4840.1, "CuCu200FF"},//<
  { 61, -32.41, 1.14,-108.70,13.55,   2.86, 2.94,   0.02, 0.00,   0.04, 0.00,  -0.15, 0.05, 6061046, 20050302,122743,22698.7, "CuCu200FF"},
  { 63,-125.85, 1.78,-226.20,18.69,  19.64, 5.02,   0.00, 0.00,   0.03, 0.00,  -0.15, 0.07, 6063052, 20050304,194755,17777.7, "CuCu200FF"},
  { 64,-142.76, 1.48,-276.29,15.63,  13.01, 3.47,  -0.02, 0.00,   0.01, 0.00,   0.16, 0.05, 6064073, 20050305,181946, 9271.3, "CuCu200FF"},
  { 65, -38.17, 6.41,-212.22, 6.17,  53.43, 5.36,  -0.02, 0.01,   0.03, 0.01,   6.29, 0.02, 6065045, 20050306,194324,20629.7, "NoField"}, //<
  { 69,  69.23, 1.08,  -5.25, 0.81, -10.78, 2.11,   0.02, 0.00,   0.00, 0.00,  -0.02, 0.00, 6069100, 20050309, 61908, 1028.9, "CuCu62FF"},
  { 73,  41.02, 1.19,  -5.13, 0.69,  -5.51, 2.05,   0.03, 0.00,  -0.00, 0.00,  -0.01, 0.00, 6073023, 20050314,123550, 1270.1, "CuCu62FF"},
  { 81,  36.86, 0.96,  -0.99, 0.52,  26.09, 1.66,  -0.01, 0.01,   0.02, 0.00,  -0.06, 0.03, 6081041, 20050316,195612, 1791.2, "CuCu62FF"}
};
const Int_t Nrun = sizeof(Run)/sizeof(Run_t);
struct BPoint_t {
  Float_t day;
  Float_t X, dX, Y, dY, Z, dZ, alpha, dalpha, beta, dbeta, gamma, dgamma, slope, dslope, sys;
};
const Char_t *vNames = "day:X:dX:Y:dY:Z:dZ:alpha:dalpha:beta:dbeta:gamma:dgamma:slope:dslope:sys";
BPoint_t BPoint[] = {
  // Pass121
  //day X             Y             Z              alpha         beta          gamma           slope       
  {20,  26.22, 6.69,  48.82, 8.22,   8.11, 8.02,  -0.04, 0.01,   0.20, 0.01,   0.47, 0.07,    -1.06, 0.01, 0},
  {20,  49.08, 6.52,   5.95, 8.42, -50.79, 1.22,   0.00, 0.06,   0.14, 0.05,  -0.29, 0.08,    -0.92, 0.01, 1},
  {20, 248.68,31.58,  70.04,22.20,-186.66,33.85,   0.02, 0.00,   1.03, 0.01,  -0.96, 0.33,    -0.54, 0.02, 2},
  {20,  99.36,14.24,  99.59, 2.20,-136.74,19.35,   0.07, 0.00,   0.28, 0.01,  -0.17, 0.10,    -0.72, 0.02, 3},
  {20,-145.66, 2.64,  13.99, 4.05,-181.85, 4.95,   0.01, 0.00,   0.74, 0.01,  -0.57, 0.01,    -0.99, 0.02, 4},
  {20,  32.24, 1.79,  72.72,22.36, -39.46, 3.01,  -0.35, 0.00,   0.17, 0.00,  -0.79, 0.10,    -0.75, 0.01, 5},
  {20,  36.23, 4.63,  50.33, 4.63, -15.82, 4.94,   0.02, 0.01,   0.12, 0.03,   0.21, 0.05,    -0.97, 0.01, 6},
  {20,  88.47, 1.17, 124.38, 7.68,-120.22, 7.75,  -0.19, 0.00,   0.41, 0.01,  -0.63, 0.03,    -0.73, 0.01, 7},
  {21,   8.40, 4.52,  55.33, 5.35, -17.78, 5.27,   0.08, 0.01,   0.16, 0.01,   0.39, 0.05,    -0.81, 0.01, 0},
  {21,  27.85, 4.48,  24.72, 5.77, -41.16, 0.99,  -0.04, 0.03,   0.19, 0.04,  -0.36, 0.06,    -0.56, 0.01, 1},
  {21, 135.46,53.54, 105.34,15.28,-175.61,22.85,   0.01, 0.00,   0.99, 0.01,  -0.12, 0.08,    -0.12, 0.01, 2},
  {21, 110.64,11.91,  93.12,17.68,-127.02,15.29,   0.09, 0.00,   0.35, 0.06,   0.24, 0.08,    -0.47, 0.01, 3},
  {21,-185.04, 1.99,  28.79, 2.69,-180.20, 3.26,   0.00, 0.00,   0.54, 0.03,  -0.37, 0.09,    -0.82, 0.01, 4},
  {21,   9.61, 1.20,  72.89,14.32, -78.68,12.43,  -0.13, 0.01,   0.29, 0.05,  -0.90, 0.06,    -0.50, 0.01, 5},
  {21,  19.55, 3.13,  64.37, 3.11, -27.55, 3.30,   0.02, 0.02,   0.08, 0.02,   0.11, 0.03,    -0.72, 0.01, 6},
  {21,  61.34, 5.67, 146.69, 5.45,-124.05, 5.44,  -0.09, 0.02,   0.44, 0.02,  -0.63, 0.01,    -0.49, 0.01, 7},
  {32,  23.41, 5.51,  57.58, 6.52,   6.32, 6.42,   0.19, 0.01,   0.14, 0.05,   0.56, 0.06,     2.09, 0.01, 0},
  {32,  19.20, 1.50,  22.47, 7.18, -35.16, 7.21,  -0.13, 0.01,   0.06, 0.05,  -0.27, 0.07,     2.23, 0.02, 1},
  {32, 109.63,68.96, 308.20,20.04,-185.71,33.35,   0.02, 0.00,   0.85, 0.02,  -0.80, 0.29,     3.06, 0.02, 2},
  {32, 140.91,12.20, 216.50, 2.14,-155.12,17.55,   0.07, 0.01,   0.26, 0.03,  -0.01, 0.09,     3.53, 0.02, 3},
  {32, 656.94,30.79,-298.25,36.79,-110.37, 5.72,   0.02, 0.00,   0.70, 0.01,  -2.56, 0.52,     2.21, 0.02, 4},
  {32, -92.19,11.83,  56.01,18.85, -52.27,17.39,  -0.22, 0.05,   0.22, 0.01,  -0.95, 0.08,     2.57, 0.01, 5},
  {32,  13.92, 3.86,  66.20, 3.82, -14.03, 0.92,   0.08, 0.01,   0.02, 0.03,   0.29, 0.04,     2.23, 0.01, 6},
  {32,  17.19, 1.05, 166.99, 6.90,-106.53, 7.07,  -0.19, 0.01,   0.40, 0.01,  -0.49, 0.03,     2.73, 0.01, 7},
  {34, 118.26, 4.30,  31.38,24.01,  39.86,23.84,   0.03, 0.01,   0.22, 0.02,   0.19, 0.16,    10.61, 0.12, 0},
  {34, -35.81,21.89,  42.46,27.39, -11.49,17.11,  -0.63, 0.04,   0.07, 0.01,   0.09, 0.26,     8.55, 0.12, 1},
  {34,  46.96,103.8,1239.21,73.7,-216.96,119.65,   0.02, 0.00,   0.91, 0.04,  -1.89, 0.04,    12.20, 0.18, 2},
  {34, 463.88,12.05, 324.69, 7.70,-174.93,66.80,   0.14, 0.02,   0.04, 0.01,  -1.42, 0.32,    12.42, 0.10, 3},
  {34,-126.16, 5.67,-1108.30,71.3,-102.26,118.9,   0.00, 0.00,   0.69, 0.03,  -0.57, 0.03,    11.22, 0.15, 4},
  {34,-693.66,43.71, -81.16,69.13,-128.14,64.07,  -0.48, 0.02,   0.07, 0.01,  -1.26, 0.31,    11.02, 0.07, 5},
  {34,  47.54,14.72,  37.67,14.52,  23.08,15.50,  -0.15, 0.02,  -0.06, 0.02,   0.24, 0.15,     9.14, 0.09, 6},
  {34, -35.27,26.12, 132.17,24.97, -88.17,25.75,  -0.12, 0.01,   0.32, 0.01,  -0.18, 0.02,    13.07, 0.04, 7},
  {44,  -7.57, 5.97,  31.85, 7.25,  13.08, 7.11,  -0.11, 0.01,   0.12, 0.05,   0.17, 0.05,    -0.85, 0.01, 0},
  {44,  19.13, 1.34,  -1.01, 8.43,  -2.82, 8.43,  -0.03, 0.06,   0.08, 0.01,  -0.19, 0.08,    -0.67, 0.01, 1},
  {44,  -8.60,58.75,   9.39, 3.28, -95.25,24.43,   0.02, 0.00,   0.67, 0.04,  -0.81, 0.25,    -0.18, 0.02, 2},
  {44,  10.38, 2.11,  56.29, 2.15,-140.95,18.41,   0.03, 0.00,   0.20, 0.01,  -0.30, 0.10,    -0.30, 0.02, 3},
  {44,-281.54, 2.59,  22.94, 3.52,-105.90, 4.92,   0.01, 0.00,   0.71, 0.01,   0.17, 0.09,    -0.65, 0.02, 4},
  {44,  -3.52,13.93,  24.51,21.28, -43.24,19.55,  -0.34, 0.00,   0.10, 0.00,  -0.57, 0.09,    -0.53, 0.01, 5},
  {44,   2.62, 4.41,  28.18, 4.34,   4.14, 0.97,  -0.05, 0.02,   0.09, 0.03,   0.10, 0.04,    -0.77, 0.01, 6},
  {44,  -9.71, 1.17,  53.06, 6.92, -78.61, 7.32,  -0.14, 0.01,   0.41, 0.01,  -0.52, 0.01,    -0.47, 0.01, 7},
  {45,  30.98, 5.87, 113.75, 7.11,  20.87, 6.99,   0.06, 0.05,   0.09, 0.01,   0.95, 0.07,    -1.35, 0.01, 0},
  {45,  78.87, 6.46,  54.35, 8.13, -18.58, 8.11,  -0.09, 0.05,   0.06, 0.01,  -1.02, 0.08,    -1.02, 0.01, 1},
  {45,-195.70,59.06, 144.28,18.27,-105.62,25.02,   0.03, 0.00,   0.36, 0.09,  -1.46, 0.07,    -0.34, 0.02, 2},
  {45,  68.58,12.59, 141.03,19.44,-130.19,18.02,   0.10, 0.01,   0.32, 0.01,   0.26, 0.09,    -0.66, 0.02, 3},
  {45, -53.38, 2.54, 140.16,19.34,-108.86, 5.07,   0.02, 0.00,   0.70, 0.01,  -0.21, 0.01,    -1.38, 0.02, 4},
  {45,  55.73, 1.39, 157.58,21.33,  24.11, 3.04,  -0.22, 0.00,   0.09, 0.01,  -1.41, 0.09,    -1.13, 0.01, 5},
  {45,  51.57, 4.32, 147.09, 4.24,   0.58, 0.82,   0.04, 0.01,   0.06, 0.03,   0.21, 0.04,    -1.23, 0.01, 6},
  {45, 101.21, 1.10, 234.51, 6.77, -76.00, 7.12,  -0.03, 0.01,   0.36, 0.03,  -0.71, 0.03,    -0.95, 0.01, 7},
  {48,-169.08, 5.29,-123.97, 6.40,  56.98, 6.46,  -0.07, 0.04,   0.31, 0.05,  -1.72, 0.06,    -1.16, 0.02, 0},
  {48,-197.43, 5.76,-131.40, 7.28, -15.71, 7.33,   0.07, 0.05,   0.01, 0.01,   1.52, 0.07,    -0.31, 0.02, 1},
  {48, 304.54,53.94,-185.60,16.64, -69.81,23.05,   0.03, 0.00,   0.48, 0.08,   2.10, 0.23,    -1.26, 0.02, 2},
  {48,-163.14,10.29,-144.45,18.38, -88.47,17.21,  -0.10, 0.05,   0.25, 0.01,  -0.89, 0.09,    -1.60, 0.02, 3},
  {48,-235.07,59.76,-225.51,18.08,-156.83,29.04,  -0.09, 0.01,   0.78, 0.09,  -1.99, 0.26,     0.03, 0.02, 4},
  {48,-415.31, 1.65,-235.05,17.97, -77.75,16.67,  -0.06, 0.01,   0.48, 0.06,   1.57, 0.08,     0.41, 0.01, 5},
  {48,-182.82, 3.87,-228.51, 3.77,  17.87, 4.04,   0.05, 0.03,   0.04, 0.03,  -0.14, 0.04,    -0.68, 0.01, 6},
  {48,-317.12, 6.55,-323.96, 6.08, -85.45, 6.43,   0.06, 0.01,   0.50, 0.03,   0.07, 0.03,    -0.55, 0.01, 7},
  {49, -50.31, 3.29, -40.49, 4.04,  17.38, 4.03,   0.09, 0.01,   0.11, 0.03,  -0.66, 0.04,    -0.77, 0.01, 0},
  {49, -39.63, 3.59, -55.56, 4.57, -29.09, 4.58,   0.06, 0.03,   0.20, 0.04,   0.19, 0.04,    -0.45, 0.01, 1},
  {49, 142.32, 1.59, -17.48, 1.83, -87.82,14.46,   0.01, 0.00,   0.37, 0.01,   0.01, 0.07,    -0.50, 0.01, 2},
  {49, -48.20, 1.10, -19.77,10.90,-136.99,10.15,  -0.02, 0.03,   0.23, 0.04,  -0.43, 0.05,    -0.60, 0.01, 3},
  {49,-182.30,39.43,-107.08,11.55,-177.38,18.59,   0.10, 0.06,   0.72, 0.05,  -0.59, 0.17,    -0.34, 0.01, 4},
  {49, -90.34, 6.99, -73.79,11.14, -69.16,10.13,   0.22, 0.00,   0.37, 0.04,   0.25, 0.05,    -0.29, 0.01, 5},
  {49, -47.32, 2.42, -74.37, 2.36,   0.92, 0.56,   0.07, 0.02,   0.04, 0.02,  -0.20, 0.02,    -0.71, 0.01, 6},
  {49, -74.70, 3.43, -91.46, 3.75,-104.33, 3.88,   0.15, 0.01,   0.42, 0.02,  -0.26, 0.02,    -0.44, 0.01, 7},
  {49, -50.31, 3.29, -40.49, 4.04,  17.38, 4.03,   0.09, 0.01,   0.11, 0.03,  -0.66, 0.04,    -0.77, 0.01, 0},
  {49, -39.63, 3.59, -55.56, 4.57, -29.09, 4.58,   0.06, 0.03,   0.20, 0.04,   0.19, 0.04,    -0.45, 0.01, 1},
  {49, 142.32, 1.59, -17.48, 1.83, -87.82,14.46,   0.01, 0.00,   0.37, 0.01,   0.01, 0.07,    -0.50, 0.01, 2},
  {49, -48.20, 1.10, -19.77,10.90,-136.99,10.15,  -0.02, 0.03,   0.23, 0.04,  -0.43, 0.05,    -0.60, 0.01, 3},
  {49,-182.30,39.43,-107.08,11.55,-177.38,18.59,   0.10, 0.06,   0.72, 0.05,  -0.59, 0.17,    -0.34, 0.01, 4},
  {49, -90.34, 6.99, -73.79,11.14, -69.16,10.13,   0.22, 0.00,   0.37, 0.04,   0.25, 0.05,    -0.29, 0.01, 5},
  {49, -47.32, 2.42, -74.37, 2.36,   0.92, 0.56,   0.07, 0.02,   0.04, 0.02,  -0.20, 0.02,    -0.71, 0.01, 6},
  {49, -74.70, 3.43, -91.46, 3.75,-104.33, 3.88,   0.15, 0.01,   0.42, 0.02,  -0.26, 0.02,    -0.44, 0.01, 7},
  {51, -98.98, 6.09, -96.55, 7.37,  49.54, 7.37,  -0.03, 0.04,   0.13, 0.06,  -1.12, 0.07,     1.11, 0.02, 0},
  {51,-152.96, 6.70, -95.14, 8.46, -18.29, 8.45,   0.07, 0.06,   0.20, 0.07,   1.01, 0.08,     2.05, 0.02, 1},
  {51, -17.26,66.78, -22.92, 3.65,-119.81, 5.91,   0.01, 0.00,   0.41, 0.05,   0.72, 0.02,     1.21, 0.02, 2},
  {51, -48.44,12.58, -40.67,19.51,-106.05,18.05,  -0.08, 0.05,   0.16, 0.01,  -0.92, 0.09,     1.22, 0.02, 3},
  {51,-707.94, 2.71,-230.35,16.76,-117.53,27.29,   0.04, 0.01,   0.62, 0.05,   0.72, 0.25,     2.02, 0.02, 4},
  {51,-348.98,13.19,-206.01,20.36, -83.90,18.61,   0.07, 0.01,   0.45, 0.01,   0.77, 0.09,     2.26, 0.01, 5},
  {51,-124.81, 4.48,-163.04, 4.35,  27.14, 1.27,   0.02, 0.03,   0.00, 0.04,  -0.07, 0.02,     1.40, 0.01, 6},
  {51,-222.00, 7.26,-216.03, 6.77, -83.49, 7.12,   0.17, 0.01,   0.40, 0.03,  -0.04, 0.03,     1.77, 0.01, 7},
  {57, -79.35, 5.50, -61.77, 6.63,  31.42, 6.59,   0.09, 0.05,   0.14, 0.05,  -0.91, 0.06,    -1.59, 0.01, 0},
  {57, -68.37, 7.24, -62.20, 8.58,   6.16, 8.71,  -0.21, 0.06,   0.28, 0.07,   0.37, 0.07,    -1.09, 0.01, 1},
  {57,  28.98, 1.76,-111.76, 7.61, -92.52,25.25,   0.01, 0.00,   0.57, 0.01,   0.16, 0.12,    -1.39, 0.02, 2},
  {57, -67.74, 1.92, -44.08,18.17,-109.98,17.04,  -0.04, 0.05,   0.17, 0.01,  -0.58, 0.09,    -1.40, 0.01, 3},
  {57,-235.28,62.36, -67.76,18.25,-141.19,30.30,   0.04, 0.00,   0.57, 0.09,  -0.57, 0.27,    -0.93, 0.02, 4},
  {57,-125.19,11.93, -99.80,19.13, -77.70,17.34,   0.16, 0.00,   0.33, 0.00,   0.62, 0.09,    -0.81, 0.01, 5},
  {57, -78.92, 4.34, -99.41, 4.23,  24.42, 4.44,  -0.06, 0.02,   0.13, 0.03,  -0.47, 0.01,    -1.42, 0.01, 6},
  {57,-119.17, 6.31,-145.38, 6.35, -99.81, 6.60,   0.08, 0.01,   0.41, 0.03,  -0.15, 0.03,    -1.00, 0.01, 7},
  {61, -13.98, 5.51, -17.60, 6.47,  41.36, 6.56,   0.18, 0.04,   0.22, 0.04,  -0.35, 0.07,     2.17, 0.01, 0},
  {61, -33.64, 1.72, -30.82, 0.85,   3.05, 8.15,  -0.01, 0.02,   0.27, 0.06,  -0.10, 0.08,     2.29, 0.01, 1},
  {61,-578.62,107.9, 261.75,33.76,-132.68, 8.49,   0.02, 0.00,   0.25, 0.09,  -3.21, 0.48,     2.63, 0.03, 2},
  {61,  96.84,11.83,  77.48,18.27,-117.73,17.18,   0.10, 0.01,   0.29, 0.01,  -0.62, 0.09,     2.82, 0.02, 3},
  {61,-304.66, 2.74,-179.95, 7.18, -96.50,26.65,   0.03, 0.00,   0.43, 0.09,   0.96, 0.24,     2.83, 0.02, 4},
  {61,-136.13,12.79, -98.85, 2.14, -90.94, 3.74,   0.25, 0.00,   0.25, 0.01,  -0.06, 0.07,     2.81, 0.02, 5},
  {61, -18.52, 4.17, -30.02, 4.08,  27.68, 4.33,   0.08, 0.01,   0.15, 0.03,  -0.15, 0.04,     2.24, 0.01, 6},
  {61, -24.77, 6.68, -34.63, 4.46, -91.81, 6.95,   0.07, 0.01,   0.23, 0.03,  -0.33, 0.01,     2.53, 0.01, 7},
  {63, -37.86, 5.87, -44.44, 7.02,  17.87, 6.87,   0.11, 0.01,   0.18, 0.05,  -0.74, 0.07,     0.74, 0.01, 0},
  {63, -54.18, 6.91, -50.28, 8.69,  10.19, 8.64,  -0.10, 0.01,   0.11, 0.04,   0.08, 0.09,     1.01, 0.01, 1},
  {63, 148.39, 1.82,  46.95,17.58, -98.56,24.79,   0.01, 0.00,   0.56, 0.01,  -0.65, 0.09,     1.10, 0.02, 2},
  {63,  12.75,11.57,  22.88,17.67,-129.43,16.51,  -0.05, 0.05,   0.24, 0.01,  -0.68, 0.08,     1.01, 0.02, 3},
  {63,-437.15, 2.37,-157.77,16.72,-153.12,27.89,   0.04, 0.00,   0.85, 0.04,   0.09, 0.24,     1.28, 0.02, 4},
  {63,-128.34, 1.67, -76.57,18.82, -33.98, 2.83,   0.21, 0.00,   0.23, 0.00,   0.23, 0.08,     1.50, 0.01, 5},
  {63, -48.37, 4.45, -72.09, 4.34,  15.26, 4.53,   0.00, 0.01,   0.21, 0.03,  -0.30, 0.04,     0.78, 0.01, 6},
  {63, -78.39, 6.38, -87.01, 6.19, -99.21, 6.55,   0.09, 0.01,   0.41, 0.02,  -0.25, 0.03,     1.31, 0.01, 7},
  {64, -44.82, 6.28, -54.86, 7.61,  55.21, 7.47,   0.21, 0.04,   0.16, 0.06,  -0.78, 0.07,     0.54, 0.01, 0},
  {64, -89.30, 5.53, -78.38, 7.77,  13.54,10.31,  -0.13, 0.02,   0.49, 0.05,   0.17, 0.08,     0.72, 0.02, 1},
  {64,  89.07, 1.94, -24.17, 3.60,-104.73,26.55,   0.01, 0.00,   0.59, 0.01,  -0.46, 0.06,     0.78, 0.02, 2},
  {64,   9.17, 9.31,   8.58,19.85,-127.03,18.24,  -0.07, 0.05,   0.21, 0.01,  -0.46, 0.08,     0.90, 0.02, 3},
  {64,-422.06, 2.44,-252.74, 6.85,-268.70, 5.04,   0.04, 0.00,   0.66, 0.10,  -0.28, 0.30,     1.10, 0.02, 4},
  {64,-149.30, 1.68, -93.08,21.01, -78.87,18.35,   0.24, 0.00,   0.24, 0.00,   0.50, 0.09,     1.25, 0.01, 5},
  {64, -61.02, 4.95, -92.60, 4.88,  41.89, 5.13,  -0.06, 0.01,   0.12, 0.03,  -0.24, 0.02,     0.58, 0.01, 6},
  {64, -98.36, 7.43,-118.70, 6.96,-102.16, 7.25,   0.09, 0.01,   0.43, 0.01,  -0.13, 0.03,     1.12, 0.01, 7}
};																									   
const Int_t N = sizeof(BPoint)/sizeof(BPoint_t);																			   
//________________________________________________________________________________
void Calc(Int_t k, Int_t i, Double_t *x, Double_t *dx) {
  x[0] = 0;
  dx[0] = -1;
  Float_t *xx = &BPoint[i].X;
  if (k >= 0 && k < 7) {
    x[0] = xx[2*k]; dx[0] = xx[2*k+1];
    //    cout << "k = " << k << " i = " << i << " x = " << x[0] << " dx = " << dx[0] << endl;
  }
  else cout << "Wrong key " << k << endl;
}
//________________________________________________________________________________
void DrawGlobal() {
  TNtuple *FitP = (TNtuple *) gDirectory->Get("FitP");
  static const Char_t *Names[8] = {"SVT Clam Shell 0", "SVT Clam Shell 1", "SSD sector 1", "SSD sector 2", 
				   "SSD sector 3", "SSD sector 4", "SVT All", "SSD All"};
  static const Char_t *Vnames[7] = {"X","Y","Z","alpha","beta","gamma","slope"};
  Int_t nx = sizeof(Vnames)/sizeof(Char_t *);
  Int_t ny = sizeof(Names)/sizeof(Char_t *);
  TString TitleC("GlobalDay");
  TCanvas *c1 = new TCanvas(TitleC,TitleC);
  c1->Divide(nx,ny);
  gStyle->SetOptStat(0);
  Int_t m = 0;
  Double_t *x  = new Double_t[N];
  Double_t *dx = new Double_t[N];
  Double_t *y  = new Double_t[N];
  Double_t *dy = new Double_t[N];
  for (Int_t k = 0; k < nx; k++) {
    Double_t ymin = 99999;
    Double_t ymax =-99999;
    for (Int_t i = 0; i < N; i++) {
      Calc(k,i,&y[i],&dy[i]);
      if (y[i]+dy[i] > ymax) ymax = y[i]+dy[i];
      if (y[i]-dy[i] < ymin) ymin = y[i]-dy[i];
    }
    if (ymax > 0) ymax *= 1.25;
    else          ymax /= 1.25;
    //    ymin *= 1.25;
    for (Int_t sys = 0; sys < 8; sys++) {
      Int_t kj = k+1 + sys*nx;
      TVirtualPad* pad = c1->cd(kj);
      TH1F* frame = pad->DrawFrame(19,ymin,82,ymax);
      TString Title; 
      if (m == 0) Title = Form("<%s> for %s",Vnames[k],Names[sys]);
      else        Title = Form("#Delta(%s) for %s",Vnames[k],Names[sys]);
      if (k < 3) Title += "[#mum]";
      else  if (k < 6) {Title += "[mrad]"; Title.ReplaceAll("<","<#");}
      else       Title += "[permill]";
      frame->SetTitle(Title);
      frame->SetXTitle("days");
      frame->SetYTitle(Vnames[k]);
      TLegend *leg = new TLegend(0.05,0.7,0.35,0.9,"");
      //      leg->AddEntry(gr,Names[sys]);
      TLine *line = new TLine(48.04,ymin,48.04,ymax);
      line->SetLineColor(2);
      //	line->SetLineWidth(4);
      line->Draw();
      TLine *line1 = new TLine(48.28,ymin,48.28,ymax);
      line1->SetLineColor(2);
      leg->AddEntry(line1,"Magnet tripped");
      //	line1->SetLineWidth(4);
      line1->Draw();
      TLine *line2 = new TLine(46.667,ymin,46.667,ymax);
      line2->SetLineColor(4);
      //	line1->SetLineWidth(4);
      line2->Draw();
      leg->AddEntry(line2,"Magnet polarity has been changed");
      TLine *line3 = new TLine(65.8215,ymin,65.8215,ymax);
      line3->SetLineColor(6);
      line3->Draw();
      TLine *line4 = new TLine(65.9465,ymin,65.9465,ymax);
      line4->SetLineColor(6);
      line4->Draw();
      leg->AddEntry(line4,"Zero Field");
      TLine *line5 = new TLine(69.417,ymin,69.417,ymax);
      line5->SetLineColor(7);
      line5->Draw();
      leg->AddEntry(line5,"CuCu 62 GeV");
      leg->Draw();
      for (Int_t p = 0; p < 1; p++) {
	Int_t n = 0;
	for (Int_t i = 0; i < N; i++) {
	  if (BPoint[i].sys != 10*p+sys) continue;
	  x[n] = BPoint[i].day;
	  dx[n] = 0;
	  Calc(k,i,&y[n],&dy[n]);
	  n++;
	}
	TGraphErrors *gr = new TGraphErrors(n,x,y,0,dy);
	gr->SetMarkerStyle(20);
	gr->SetMarkerColor(p+1);
	gr->Draw("p");
      }
    }
  }
  delete [] x;
  delete [] dx;
  delete [] y;
  delete [] dy;
}
