#include "Riostream.h"
#include "Rtypes.h"
#include "TString.h"
#include "TMath.h"
#if !defined(__CINT__)
// code that should be seen ONLY by the compiler
#else
#if !defined(__CINT__) || defined(__MAKECINT__)
// code that should be seen by the compiler AND rootcint
#else
// code that should always be seen
#endif
#endif
//________________________________________________________________________________
#if !defined(__CINT__) || defined(__MAKECINT__)
#include "Riostream.h"
#include "TROOT.h"
#include "TSystem.h"
#include "TMath.h"
#include "TH1.h"
#include "TStyle.h"
#include "TGraph.h"
#include "TNtuple.h"
#include "TCanvas.h"
#include "TString.h"
#include "TLegend.h"
#include "TFile.h"
#include "TNamed.h"
#include "THStack.h"
#include "StChain.h"
#include "tables/St_Survey_Table.h"
#include "TGeoMatrix.h"
#endif
TCanvas *c1 = 0;
THStack *hs[6];
TLegend *leg[6];
struct data_t {
  Int_t sector;
  Double_t x, Dx, y, Dy, z, Dz, alpha, Dalpha, beta, Dbeta, gamma, Dgamma;
  const Char_t *Comment;
  void Print() {
    cout << Form("%2i %8.2f %5.2f %8.2f %5.2f %8.2f %5.2f",sector, x, Dx, y, Dy, z, Dz)
	 << Form(" %8.2f %5.2f %8.2f %5.2f %8.2f %5.2f %s", alpha, Dalpha, beta, Dbeta, gamma, Dgamma, Comment) << endl;
  }
};
class SurveyPass_t {
 public:
  Int_t date, time;
  const Char_t *PassName;
  data_t Data[24];
  void Print() {
    cout << Form("%8i %6i %s",date,time,PassName) << endl;
    for (Int_t i = 0; i < 24; i++) {
      Data[i].Print();
    }
  }
};
SurveyPass_t Passes[] = {
  {20140104,     1112, "Pxl 0.5 GeV", // AuAu200LomLum
   {
	{ 1,  -7.57, 0.12,  12.90, 0.18,   3.41, 4.33,  -0.08, 0.00,  -0.09, 0.00,   0.06, 0.01,"Average "},
	{ 2,  -4.44, 0.06,  83.67, 0.50,  28.47, 4.00,  -0.11, 0.00,  -0.04, 0.00,   0.31, 0.01,"Average "},
	{ 3,   7.45, 0.07,  11.63, 0.21,  53.73, 4.39,  -0.14, 0.00,   0.05, 0.00,  -0.15, 0.01,"Average "},
	{ 4,  12.49, 0.14,   9.25, 0.12,  94.80, 3.99,  -0.11, 0.00,   0.09, 0.00,   0.20, 0.01,"Average "},
	{ 5,  -0.11, 0.42,  -2.05, 0.06, 110.57, 4.54,  -0.05, 0.00,   0.05, 0.00,  -0.06, 0.00,"Average "},
	{ 6,  -3.65, 0.48,  -1.98, 0.06,  74.56, 5.14,  -0.08, 0.00,  -0.06, 0.00,  -0.13, 0.00,"Average "},
	{ 7,  -9.03, 0.38,  25.38, 0.50,  60.63, 5.30,  -0.02, 0.00,  -0.09, 0.00,  -0.20, 0.01,"Average "},
	{ 8,  -1.79, 0.07,  33.50, 0.29,  81.06, 1.48,  -0.04, 0.00,  -0.03, 0.00,  -0.11, 0.00,"Average "},
	{ 9,   2.64, 0.07,  50.87, 0.29,  94.45, 1.30,  -0.17, 0.00,   0.01, 0.00,  -0.25, 0.00,"Average "},
	{10,  10.56, 0.18,  12.52, 0.17,  42.36, 4.72,  -0.11, 0.00,   0.05, 0.00,  -0.38, 0.00,"Average "},
	{11,  -2.51, 0.55,   3.53, 0.07,  -6.26, 4.93,  -0.02, 0.00,   0.06, 0.00,  -0.28, 0.01,"Average "},
	{12, -54.74, 0.42,  11.23, 0.08,  20.48, 5.15,  -0.03, 0.00,  -0.08, 0.00,   0.42, 0.01,"Average "},
	{13,  -5.59, 0.56,   2.17, 0.07,  -1.43, 5.27,  -0.01, 0.00,  -0.07, 0.00,  -0.08, 0.00,"Average "},
	{14, -13.53, 0.37,  -0.40, 0.35,  25.37, 4.53,  -0.09, 0.00,   0.03, 0.00,   0.12, 0.01,"Average "},
	{15,  -4.58, 0.07,   0.11, 0.32, 113.96, 1.30,  -0.11, 0.00,   0.03, 0.00,  -0.20, 0.01,"Average "},
	{16,  -1.43, 0.07,  24.66, 0.30,  93.33, 1.54,  -0.02, 0.00,  -0.00, 0.00,  -0.02, 0.00,"Average "},
	{17,  -1.01, 0.16,  -1.03, 0.15, -74.55, 5.94,  -0.07, 0.00,  -0.03, 0.00,  -0.22, 0.01,"Average "},
	{18,   7.08, 0.25,  -6.51, 0.06, -78.79, 5.43,  -0.14, 0.00,  -0.04, 0.00,  -0.06, 0.00,"Average "},
	{19,  35.22, 0.47,   0.17, 0.07, -73.71, 4.57,  -0.02, 0.00,  -0.04, 0.00,   0.20, 0.00,"Average "},
	{20,   0.60, 0.14,  -2.75, 0.12, -28.03, 4.10,  -0.01, 0.00,   0.02, 0.00,  -0.00, 0.01,"Average "},
	{21,   5.56, 0.07,   6.81, 0.20, -13.67, 4.52,   0.00, 0.00,  -0.01, 0.00,   0.05, 0.00,"Average "},
	{22,  -1.57, 0.05,  47.63, 0.51,  -0.80, 3.88,  -0.08, 0.00,  -0.01, 0.00,   0.14, 0.00,"Average "},
	{23,  -5.14, 0.12,   4.00, 0.60, 100.17, 1.28,  -0.01, 0.00,   0.00, 0.00,   0.06, 0.01,"Average "},
	{24, -28.63, 0.42,   7.67, 0.07, -10.05, 5.28,   0.01, 0.00,  -0.02, 0.00,   0.08, 0.00,"Average "},
   }												   
  }
  ,
  {20140104,     1113, "Pxl 1 GeV", // AuAu200LomLum
   {
	{ 1,  -7.01, 0.37,  35.79, 0.48, -37.11,15.48,  -0.15, 0.01,  -0.18, 0.00,   0.80, 0.01,"Average "},
	{ 2,  -0.55, 0.10,  63.44, 0.80,  -8.03,13.96,  -0.21, 0.01,  -0.07, 0.00,   0.45, 0.01,"Average "},
	{ 3,  11.70, 0.15,  73.91, 0.57, 174.47, 3.26,  -0.19, 0.01,   0.07, 0.00,   0.29, 0.01,"Average "},
	{ 4,   4.64, 0.39,  16.09, 0.34, 155.25,14.26,  -0.18, 0.00,   0.18, 0.01,   0.68, 0.01,"Average "},
	{ 5,   6.75, 0.73,  -3.96, 0.14, 143.02,16.34,  -0.04, 0.00,   0.05, 0.01,  -0.14, 0.01,"Average "},
	{ 6,  -4.13, 0.96,   0.61, 0.12, 134.42,19.20,  -0.07, 0.00,  -0.09, 0.01,  -0.09, 0.01,"Average "},
	{ 7, -19.77, 0.41,  19.88, 0.39,  92.39,17.66,  -0.11, 0.01,  -0.17, 0.01,  -0.29, 0.01,"Average "},
	{ 8,  -4.77, 0.15,  39.35, 0.71,  74.70, 3.20,  -0.18, 0.01,  -0.02, 0.00,  -0.26, 0.01,"Average "},
	{ 9,   5.18, 0.12,  27.68, 0.51,  24.22,14.68,  -0.22, 0.01,   0.04, 0.00,  -0.15, 0.01,"Average "},
	{10,  23.92, 0.50,  32.45, 0.50,  10.03,22.06,  -0.18, 0.01,   0.19, 0.01,  -0.75, 0.01,"Average "},
	{11,   7.87, 1.54,   2.58, 0.13, -70.46,17.59,  -0.01, 0.00,   0.09, 0.01,  -0.02, 0.00,"Average "},
	{12, -66.04, 0.74,  15.53, 0.17,  38.70,19.59,  -0.07, 0.00,  -0.23, 0.01,   0.45, 0.01,"Average "},
	{13,   9.72, 0.67,   1.11, 0.13,  28.85,21.18,  -0.01, 0.00,  -0.05, 0.01,   0.02, 0.01,"Average "},
	{14,  -4.06, 0.41,  -6.69, 0.44,  84.77,18.77,  -0.07, 0.01,   0.04, 0.01,   0.10, 0.01,"Average "},
	{15,  -4.28, 0.12, -12.89, 0.76,  77.34,14.37,  -0.08, 0.01,   0.08, 0.00,  -0.15, 0.01,"Average "},
	{16,  -1.77, 0.15,  12.10, 1.09, -10.07,20.07,   0.03, 0.01,  -0.01, 0.00,  -0.15, 0.01,"Average "},
	{17,   0.53, 0.42,  -0.09, 0.39, -86.74,22.38,  -0.04, 0.01,  -0.04, 0.01,  -0.07, 0.01,"Average "},
	{18,  19.59, 0.92,  -6.48, 0.12, -93.66,18.25,  -0.09, 0.00,  -0.11, 0.01,   0.02, 0.01,"Average "},
	{19,  19.04, 0.76,   0.20, 0.15, -83.02,16.85,  -0.09, 0.00,  -0.04, 0.01,   0.27, 0.01,"Average "},
	{20,  -5.83, 0.33,   0.23, 0.29, -33.10,12.42,  -0.07, 0.01,   0.03, 0.01,   0.01, 0.01,"Average "},
	{21,   5.01, 0.13,  46.49, 0.59, 105.98, 3.38,   0.02, 0.01,   0.04, 0.00,   0.14, 0.01,"Average "},
	{22,  -0.58, 0.09,  24.63, 0.69,  18.96,12.68,  -0.04, 0.01,  -0.01, 0.00,   0.15, 0.01,"Average "},
	{23,  -1.08, 0.28,  23.87, 0.51,  51.15,14.83,  -0.07, 0.01,   0.00, 0.01,   0.56, 0.01,"Average "},
	{24, -38.14, 0.68,   9.32, 0.16,  11.14,20.75,   0.02, 0.00,   0.16, 0.01,   0.30, 0.01,"Average "},
   }												   
  }
  ,
  {20140104,     1114, "Ist 1 GeV", // AuAu200LomLum
   {
	{ 1, -71.60, 0.88,  64.49, 1.00, -92.55,197.01,  -0.06, 0.01,  -0.03, 0.01,   0.18, 0.03,"Average "},
	{ 2, -13.85, 0.28, 122.21, 4.98,-619.78,258.42,   0.30, 0.01,   0.01, 0.00,   0.24, 0.01,"Average "},
	{ 3,  12.38, 0.18, 152.18, 4.87,-1019.11,290.9,   0.20, 0.01,  -0.00, 0.00,   0.07, 0.01,"Average "},
	{ 4,  40.21, 0.73,  45.41, 0.81,-1113.16,533.9,   0.12, 0.01,  -0.12, 0.01,  -0.04, 0.03,"Average "},
	{ 5, -43.50, 1.11,  -6.56, 0.30,-159.54,113.19,   0.05, 0.00,  -0.08, 0.01,  -0.04, 0.01,"Average "},
	{ 6, -26.82, 1.19,   2.76, 0.18,-217.56,123.44,  -0.04, 0.00,  -0.24, 0.01,  -0.03, 0.01,"Average "},
	{ 7, -49.63, 0.75,  44.56, 0.72,-409.23,324.15,  -0.31, 0.00,  -0.15, 0.01,  -0.50, 0.03,"Average "},
	{ 8,  -5.85, 0.30,  35.10, 5.40,-241.49,127.88,  -0.09, 0.01,  -0.04, 0.00,  -0.08, 0.01,"Average "},
	{ 9,   5.11, 0.18,  72.27, 4.66,-207.60,175.46,   0.03, 0.01,   0.04, 0.00,  -0.17, 0.01,"Average "},
	{10,  59.40, 0.93,  58.06, 0.90, 457.88,279.16,  -0.09, 0.01,   0.16, 0.01,   0.01, 0.03,"Average "},
	{11,  43.88, 1.18,   0.47, 0.28,-140.30,119.72,  -0.04, 0.00,   0.20, 0.01,   0.28, 0.01,"Average "},
	{12,-177.37, 1.25,  13.63, 0.21, 440.03,222.03,  -0.01, 0.00,   0.05, 0.01,   0.37, 0.01,"Average "},
	{13,  24.60, 1.26,  -1.44, 0.29,-287.86,148.93,  -0.00, 0.00,   0.01, 0.01,  -0.01, 0.02,"Average "},
	{14, -20.69, 0.75, -23.58, 0.79, 150.25,161.37,  -0.00, 0.01,   0.06, 0.01,   0.27, 0.03,"Average "},
	{15,  -9.38, 0.18,-131.22, 4.61, 951.75,540.05,  -0.07, 0.01,   0.03, 0.00,   0.06, 0.01,"Average "},
	{16,   1.36, 0.30,  -8.38, 4.44, 107.24,175.11,  -0.11, 0.01,  -0.05, 0.00,  -0.07, 0.01,"Average "},
	{17,  15.71, 0.84, -12.15, 0.70,-337.89,  0.62,  -0.21, 0.01,  -0.18, 0.01,  -0.03, 0.03,"Average "},
	{18,  78.86, 1.32,  -8.27, 0.18,-262.01,112.23,  -0.04, 0.00,  -0.00, 0.01,   0.05, 0.01,"Average "},
	{19,  52.28, 1.21,  11.22, 0.31,-197.15,150.15,   0.05, 0.00,  -0.02, 0.01,   0.02, 0.02,"Average "},
	{20, -24.97, 0.74, -26.40, 0.84,  26.66,143.57,   0.05, 0.01,  -0.05, 0.01,   0.05, 0.03,"Average "},
	{21,   5.25, 0.18,  99.79, 4.24,  66.72,203.02,  -0.18, 0.01,   0.01, 0.00,   0.14, 0.01,"Average "},
	{22,  -8.03, 0.27,  64.70, 4.40, 108.12,167.56,  -0.07, 0.01,  -0.02, 0.00,   0.10, 0.01,"Average "},
	{23, -61.52, 0.80,  50.08, 1.18, 221.46,139.41,  -0.14, 0.01,  -0.17, 0.01,  -0.25, 0.04,"Average "},
	{24, -88.79, 1.29,   5.43, 0.22,-402.29,305.82,  -0.04, 0.00,  -0.39, 0.01,   0.11, 0.01,"Average "},
   }												   
  }
  ,
  {20140104,     1116, "Pxl 1 GeV Glob", // AuAu200LomLum
   {
	{ 1,   2.27, 0.32,  33.66, 0.98,   1.01,14.66,  -0.07, 0.01,  -0.02, 0.01,   0.31, 0.04,"Average "},
	{ 2,  -1.93, 0.16,  39.79, 1.41,  14.94,20.13,  -0.10, 0.01,  -0.03, 0.00,  -0.15, 0.02,"Average "},
	{ 3,   2.17, 0.28,   2.72, 0.66, 156.36,128.4,  -0.06, 0.01,   0.05, 0.01,  -0.14, 0.04,"Average "},
	{ 4,  -0.65, 0.43,   0.99, 0.36,  54.72,16.52,  -0.05, 0.01,   0.04, 0.01,   0.72, 0.03,"Average "},
	{ 5,  68.77, 1.44, -27.59, 0.97, 207.37,178.3,  -0.08, 0.00,   0.03, 0.01,   0.05, 0.02,"Average "},
	{ 6,  41.57, 1.08,  -1.55, 0.20,  34.88,28.93,  -0.12, 0.00,   0.04, 0.01,   0.26, 0.03,"Average "},
	{ 7,  18.76, 1.29, -22.37, 1.37, -25.49,25.70,   0.03, 0.01,   0.10, 0.01,  -0.01, 0.04,"Average "},
	{ 8,  -0.09, 0.26, -20.93, 1.71, -60.93,36.80,   0.04, 0.01,   0.09, 0.00,  -0.16, 0.03,"Average "},
	{ 9,  -3.17, 0.30, -46.15, 1.40,  72.09,24.35,   0.21, 0.02,  -0.01, 0.01,   0.64, 0.02,"Average "},
	{10, -11.98, 1.64, -23.73, 1.66, -39.93,34.20,   0.12, 0.02,  -0.06, 0.02,   1.33, 0.05,"Average "},
	{11, -58.18, 2.00,   3.23, 0.21, -71.85,45.32,  -0.02, 0.00,  -0.13, 0.02,  -0.12, 0.01,"Average "},
	{12, -18.61, 1.64, -11.70, 0.65,   6.74,21.79,  -0.01, 0.00,  -0.02, 0.02,   0.03, 0.03,"Average "},
	{13, -40.82, 2.61,   2.05, 0.21,-111.91,649.8,  -0.03, 0.00,  -0.04, 0.02,  -0.19, 0.01,"Average "},
	{14, -47.44, 1.26, -44.08, 1.13,  -4.45,11.35,  -0.17, 0.02,   0.11, 0.02,   1.25, 0.05,"Average "},
	{15,  -1.76, 0.31, -43.74, 1.19,  18.93,24.95,  -0.31, 0.02,  -0.03, 0.01,   0.60, 0.02,"Average "},
	{16,   0.23, 0.26, -19.65, 1.57, -61.85,51.78,  -0.09, 0.01,  -0.02, 0.00,  -0.64, 0.03,"Average "},
	{17,   5.29, 1.78, -40.37, 1.07,  -0.45,11.02,  -0.04, 0.01,  -0.01, 0.01,  -0.16, 0.04,"Average "},
	{18,  41.81, 1.14,  -4.75, 0.20, -61.19,88.02,  -0.33, 0.00,  -0.01, 0.01,   0.43, 0.02,"Average "},
	{19, -13.19, 1.30,  -5.60, 0.23, -36.69,27.92,  -0.05, 0.00,  -0.03, 0.01,   0.25, 0.02,"Average "},
	{20,   0.13, 0.45,  -1.84, 0.36, -69.27,63.98,  -0.01, 0.01,  -0.03, 0.01,   0.17, 0.03,"Average "},
	{21,   2.43, 0.27,  26.19, 1.55,   2.55,32.51,   0.08, 0.01,   0.08, 0.01,   0.19, 0.03,"Average "},
	{22,  -0.51, 0.15,  69.71, 1.78, -28.11,32.53,   0.10, 0.01,  -0.01, 0.00,   0.17, 0.02,"Average "},
	{23,   3.27, 0.31,   2.14, 0.62,   1.35,12.49,   0.08, 0.01,  -0.02, 0.00,  -0.16, 0.04,"Average "},
	{24,  -6.81, 1.62,  -8.95, 0.65, -19.39,56.46,   0.02, 0.00,   0.09, 0.02,   0.02, 0.05,"Average "},
   }												   
  }
  ,
  {20140104,     1117, "Ist 1 GeV Glob", // AuAu200LomLum
   {
	{ 1,-229.37, 2.04, 150.48, 2.83, -58.69,19.41,  -0.02, 0.02,   0.06, 0.02,   0.30, 0.09,"Average "},
	{ 2, -47.62, 0.70, 313.08, 5.16,-211.87,13.14,   0.19, 0.03,  -0.00, 0.01,   0.49, 0.04,"Average "},
	{ 3,  26.51, 0.41, 235.61, 5.03,-300.54,13.67,   0.38, 0.03,   0.00, 0.00,  -0.03, 0.03,"Average "},
	{ 4, 113.51, 2.16, 133.06, 2.43,-364.63,13.33,  -0.03, 0.02,   0.07, 0.02,   0.25, 0.08,"Average "},
	{ 5, -50.07, 3.03,  39.71, 0.70,-366.49,12.69,   0.01, 0.01,  -0.17, 0.02,   0.38, 0.03,"Average "},
	{ 6,  39.17, 5.42, -19.28, 0.37,-364.22,11.69,  -0.01, 0.00,  -0.36, 0.02,  -0.05, 0.02,"Average "},
	{ 7,  98.02, 2.35,-131.45, 1.65,-412.69,11.54,  -0.01, 0.01,  -0.13, 0.02,  -0.74, 0.07,"Average "},
	{ 8,  44.90, 0.73,-247.24, 4.76,-347.64,12.10,  -0.22, 0.02,   0.01, 0.01,  -0.14, 0.04,"Average "},
	{ 9, -23.29, 0.40,-319.77, 5.83,-132.04,11.81,  -0.31, 0.03,   0.05, 0.00,  -0.51, 0.03,"Average "},
	{10,-173.46, 2.22,-183.37, 2.22,  53.01,15.37,  -0.06, 0.02,  -0.01, 0.02,   0.43, 0.08,"Average "},
	{11,-225.77, 2.69, -48.32, 0.72,-188.81,13.66,  -0.03, 0.01,   0.24, 0.03,   0.33, 0.04,"Average "},
	{12,-238.17, 2.76,  24.53, 0.45, -77.89,15.03,  -0.02, 0.01,   0.25, 0.03,  -0.47, 0.03,"Average "},
	{13,-201.05, 2.78, -45.42, 0.75,  73.46,13.09,   0.03, 0.01,  -0.08, 0.03,   0.22, 0.04,"Average "},
	{14,-134.77, 2.34,-157.10, 2.58, 173.60,11.82,   0.08, 0.02,   0.02, 0.02,   0.06, 0.08,"Average "},
	{15, -26.20, 0.40,-364.18, 6.21,  42.24,13.51,   0.12, 0.03,   0.01, 0.00,  -0.41, 0.03,"Average "},
	{16,  51.83, 0.77,  -5.77, 2.93,-141.90,12.98,   0.01, 0.02,  -0.01, 0.01,   0.53, 0.04,"Average "},
	{17, 141.36, 2.53,-173.78, 1.66,-292.69,13.12,  -0.13, 0.02,  -0.04, 0.02,  -0.11, 0.08,"Average "},
	{18, 187.46, 3.84, -23.98, 0.39,-311.67,15.83,  -0.04, 0.00,   0.40, 0.02,  -0.22, 0.03,"Average "},
	{19, 173.43, 3.89,  48.88, 0.80,-235.61,12.73,   0.05, 0.01,   0.05, 0.03,   0.34, 0.04,"Average "},
	{20,  81.58, 2.17, 101.81, 2.48,-147.00,16.05,  -0.11, 0.02,   0.03, 0.02,  -0.42, 0.08,"Average "},
	{21,  22.27, 0.38, 222.92, 4.80, 100.95,14.03,  -0.43, 0.03,  -0.03, 0.00,   0.13, 0.03,"Average "},
	{22, -46.47, 0.70, 285.49, 5.21, 117.30,11.83,  -0.05, 0.02,   0.00, 0.01,   0.27, 0.03,"Average "},
	{23,-161.07, 3.00, 207.79, 2.15, 116.84,15.76,   0.06, 0.02,   0.01, 0.02,   0.01, 0.09,"Average "},
	{24, -39.49, 6.75,  19.53, 0.45,-161.62,16.24,  -0.02, 0.00,  -0.21, 0.03,   0.42, 0.03,"Average "},
   }												   
  }
};
const  Int_t NP = sizeof(Passes)/sizeof(SurveyPass_t);
//________________________________________________________________________________
void HftG24(const Char_t *opt = "") {
  gStyle->SetMarkerStyle(20);
  gStyle->SetOptStat(0);
  cout << "NP \t" << NP << endl;
  Int_t NH = NP;
  if (NH == 2) NH++; // make average if we have only FF + RF
  TH1D ***dath = new TH1D**[NH]; 
  for (Int_t p = 0; p < NH; p++) {dath[p] = new TH1D*[6]; memset(dath[p],0, 6*sizeof(TH1D*));}
  const Char_t *names[6] = {" #Deltax"," #Deltay"," #Deltaz"," #Delta #alpha"," #Delta #beta"," #Delta #gamma"};
  const Char_t *nameK[6] = {"Dx","Dy","Dz","Da",     "Db",    "Dg"};
  TString Opt(opt);
  for (Int_t i = 0; i < 6; i++) {
    hs[i] = new THStack(nameK[i],names[i]);
    Double_t ymin =  1e10;
    Double_t ymax = -1e10;
    TString Name;
    TString Title;
    if (! i)     leg[i] = new TLegend(0.10,0.65,0.30,0.90);
    else         leg[i] = 0;
    TString same("e");
    Int_t color = 1;
    TH1::SetDefaultSumw2(kTRUE);
    for (Int_t k = 0; k < NP; k++) {
      if (k < NP) {
	if (i == 0 && k < NP) Passes[k].Print();
	Name = Form("%s%s",Passes[k].PassName,nameK[i]);
	if (Opt != "" && ! Name.Contains(Opt,TString::kIgnoreCase)) continue;
	Title = Form("Alignment fit for  %s %s",names[i],Passes[k].PassName);
      } else { // Average
	Name = Form("%s%s%s",Passes[0].PassName,Passes[1].PassName,nameK[i]);
	if (Opt != "" && ! Name.Contains(Opt,TString::kIgnoreCase)) continue;
	Title = Form("Alignment fit for %s sum %s %s",names[i],Passes[0].PassName,Passes[1].PassName);
	
      }
      //      cout << Name.Data() << "\t" << Title.Data() << "\ti\t" << i << "\tk\t" << k << endl;
      dath[k][i] = (TH1D *) gDirectory->Get(Name);
      if (dath[k][i]) delete dath[k][i];
      
      dath[k][i] = new TH1D(Name,Title, 24, 0.5, 24.5);
      //      cout << "Create: " << dath[k][i]->GetName() << "\t" << dath[k][i]->GetTitle() << endl;
      dath[k][i]->SetMarkerColor(color);
      dath[k][i]->SetLineColor(color);
      color++;
      dath[k][i]->SetXTitle("Tpc Sector");
      if (i < 3) dath[k][i]->SetYTitle(Form("%s (#mum)",names[i]));
      else       dath[k][i]->SetYTitle(Form("%s (mrad)",names[i]));
      for (Int_t l = 0; l < 24; l++) {
	Int_t secs;
	Double_t val, err;
	if (k < NP) {
	  Double_t *X = &Passes[k].Data[l].x;
	  secs = Passes[k].Data[l].sector;
	  if (X[2*i+1] >= 0 /* && X[2*i+1] < 99 */) {
	    val = X[2*i];
	    err = X[2*i+1];
	  } else {continue;}
	} else {
	  Double_t *X0 = &Passes[0].Data[l].x;
	  Double_t *X1 = &Passes[1].Data[l].x;
	  secs = Passes[0].Data[l].sector;
	  if (X0[2*i+1] >= 0 /* && X0[2*i+1] < 99 */ &&
	      X1[2*i+1] >= 0 /* && X1[2*i+1] < 99 */) {
	    val = 0.5*(X0[2*i] + X1[2*i]);
	    dath[k][i]->SetBinContent(secs,val);
	    err = TMath::Sqrt(X0[2*i+1]*X0[2*i+1]+X1[2*i+1]*X1[2*i+1])/2;
	  } else {continue;}
	} 
	if (err < 0.001) err = 0.001;
	dath[k][i]->SetBinContent(secs,val);
	dath[k][i]->SetBinError(secs,err);
	if (ymin > val - err) ymin = val - err;
	if (ymax < val + err) ymax = val + err;
      }
      hs[i]->Add(dath[k][i]);
      if (leg[i]) {
	if (k < NP) leg[i]->AddEntry(dath[k][i],Passes[k].PassName);
	else        leg[i]->AddEntry(dath[k][i],"sum");
      }
    }
  }
  c1 = new TCanvas("IO","Tpc Outer to Inner alignment parameters",1200,800);
  c1->Divide(3,2);
  for (Int_t i = 0; i < 6; i++) {
    c1->cd(i+1);
    if (! hs[i]) continue;
    TString same("e");
    Double_t ymax = hs[i]->GetMaximum("nostack");
    Double_t ymin = hs[i]->GetMinimum("nostack");
    TList *list = hs[i]->GetHists();
    TIter next(list);
    TH1 *h = 0;
    while ((h = (TH1*) next())) {
      h->GetYaxis()->SetTitleOffset(1.4);
      if (same == "e") {
	if (ymax > 0)     h->SetMaximum(1.1*ymax);
	else              h->SetMaximum(0.9*ymax);
	if (ymin < 0)     h->SetMinimum(1.1*ymin);
	else              h->SetMinimum(0.9*ymin);
      }
      TString hName(h->GetName());
      if (hName.BeginsWith("db",TString::kIgnoreCase)) h->Draw("same");
      else                                             h->Draw(same);
      same = "same";
    }
    if (leg[i]) leg[i]->Draw();
  }
  c1->Update();

  
}
