//  Compare fields for lasers 2021
#if !defined(__CINT__)
// code that should be seen ONLY by the compiler
#else
#if !defined(__CINT__) || defined(__MAKECINT__)
// code that should be seen by the compiler AND rootcint
#else
// code that should always be seen
#endif
#endif
//________________________________________________________________________________
#if !defined(__CINT__) || defined(__MAKECINT__)
#include "Riostream.h"
#include "TROOT.h"
#include "TSystem.h"
#include "TMath.h"
#include "TH1.h"
#include "TStyle.h"
#include "TGraph.h"
#include "TNtuple.h"
#include "TCanvas.h"
#include "TString.h"
#include "TLegend.h"
#include "TFile.h"
#include "THStack.h"
#endif
//#include "IOSectorPar.h"
struct data_t {
  Int_t sector;
  Double_t x, Dx, y, Dy, z, Dz, alpha, Dalpha, beta, Dbeta, gamma, Dgamma;
  const Char_t *Comment;
  void Print() {
    cout << Form("%2i %8.2f %5.2f %8.2f %5.2f %8.2f %5.2f",sector, x, Dx, y, Dy, z, Dz)
	 << Form(" %8.2f %5.2f %8.2f %5.2f %8.2f %5.2f %s", alpha, Dalpha, beta, Dbeta, gamma, Dgamma, Comment) << endl;
  }
};
struct SurveyPass_t {
  Int_t date, time;
  const Char_t *PassName;
  data_t Data[24];
#if 0
  SurveyPass_t &operator=(Int_t d, Int_t t, const Char_t *Pass, data_t data[24]) {
    date = d; time = t; PassName = Pass;
    for (Int_t i = 0; i < 24; i++) Data[i] = data[i];
    return *this;
  }
#endif
  void Print() {
    cout << Form("%8i %6i %s",date,time,PassName) << endl;
    for (Int_t i = 0; i < 24; i++) {
      Data[i].Print();
    }
  }
};
/*
drwxrwxrwx 1 jml   21743 11 Mar  3 08:07 /hlt/cephfs/daq/2021/062/22062014/ RF    22062002  22062009 22062014
drwxrwxrwx 1 jml   21743 11 Mar  3 08:52 /hlt/cephfs/daq/2021/062/22062015/ RHF .
drwxrwxrwx 1 jml   21743 21 Mar  3 09:58 /hlt/cephfs/daq/2021/062/22062016/ ZF  .
drwxrwxrwx 1 jml   21743 11 Mar  3 12:28 /hlt/cephfs/daq/2021/062/22062018/ FF    22062028
drwxrwxrwx 1 jml   21743 11 Mar  3 13:14 /hlt/cephfs/daq/2021/062/22062019/ FHF.
*/
const Int_t N = 24;
SurveyPass_t Passes[] = {
  {20210303,  101, "RF", // 
      {
	{ 1,-215.05, 6.82,1223.21,99.99,  -4.03, 7.15,  -0.05, 0.09,   0.10, 0.05,   0.04, 0.02,"Average "},
	{ 2,  62.18, 1.30, 390.69, 7.58,-106.01, 0.82,  -0.25, 0.01,  -0.13, 0.00,  -0.83, 0.02,"Average "},
	{ 3,   9.06, 4.64, -44.86,33.93,-695.19, 1.92,   0.04, 0.02,   0.09, 0.02,  -0.05, 0.02,"Average "},
	{ 4, 207.09, 1.62,  27.29, 7.29,  24.86, 0.39,  -0.12, 0.01,   0.27, 0.00,  -1.95, 0.02,"Average "},
	{ 5, 223.00,11.42,-971.94,77.87,-1048.70, 7.76,   0.34, 0.04,   0.53, 0.04,  13.20, 0.08,"Average "},
	{ 6,  41.90, 6.16, 561.70,27.81, -40.63, 2.14,  -0.89, 0.03,  -0.40, 0.01,  -0.29, 0.06,"Average "},
	{ 7,-4665.54,99.99,3399.71,99.99,-1496.47,99.99,   1.71, 0.70,  -1.21, 1.17,  -4.69, 1.70,"Average "},
	{ 8,-239.80, 0.75, -48.20, 6.10,-196.99, 1.64,  -0.16, 0.01,   0.21, 0.00,   2.04, 0.02,"Average "},
	{ 9,-4854.24,99.99,-268.48,99.99,  74.37,18.92,   1.25, 0.16,   1.27, 0.31,  -0.06, 0.16,"Average "},
	{10,4608.82,99.99,-1258.51,99.99,-103.73,26.43,  -0.24, 0.28,   0.41, 0.37,   0.63, 0.30,"Average "},
	{11,1929.77,99.99,-294.09,99.99,-696.46,99.99,   0.22, 0.61,   2.19, 2.06,   4.02, 2.02,"Average "},
	{12, -34.04,10.64, 118.99,61.99,-126.39, 1.94,   0.23, 0.02,  -0.04, 0.02,  -0.51, 0.05,"Average "},
	{13,-161.66,30.10,-991.14,99.99, 121.20, 1.32,  -0.01, 0.11,  -1.44, 0.13, -59.67, 0.03,"Average "},
	{14,-324.21,22.62,-2586.89,99.99,-129.77, 8.40,  -0.57, 0.06,   0.02, 0.05,  -0.28, 0.10,"Average "},
	{15,14282.07,99.99,-1908.59,99.99,-239.35,34.00,   0.85, 0.22,   0.25, 0.10,   0.38, 0.20,"Average "},
	{16, 214.05, 1.56, 455.26, 7.77,-810.13, 0.69,  -0.40, 0.01,   0.01, 0.00,  -0.05, 0.01,"Average "},
	{17, 439.78,54.37, 122.87,99.99,-594.46,14.86,  -1.51, 0.13,  -0.31, 0.03,  52.65, 0.35,"Average "},
	{18,-348.74,11.46, 139.03,24.25,-702.43, 2.69,  -0.20, 0.01,   0.58, 0.01,   0.32, 0.03,"Average "},
	{19,1085.92,99.99, 418.93,99.99,-241.49,21.48,   2.14, 0.22,   0.45, 0.10, -63.12, 0.23,"Average "},
	{20,-130.40, 1.30,  31.15, 3.15, -26.19, 0.82,   0.04, 0.00,   0.08, 0.00,   0.25, 0.01,"Average "},
	{21, 499.89,91.87,-2325.01,99.99,-326.32,13.27,   0.92, 0.23,  -1.11, 0.09, 173.59, 0.17,"Average "},
	{22,-126.85, 1.30,-975.73, 8.28, 139.19, 0.76,   0.74, 0.01,  -0.31, 0.00,   1.17, 0.02,"Average "},
	{23,3807.07,99.99,-417.98,99.99, 594.86,99.99,  -0.37, 0.60,  -0.80, 1.01,   1.92, 1.94,"Average "},
	{24,-158.97, 2.90,-107.14,10.85,  36.02, 1.74,   0.19, 0.01,  -0.16, 0.00,   0.48, 0.02,"Average "},
    }
  },
  {20210303,  104, "FF", // 
      {
	{ 1, 372.48, 1.76,   6.34,15.54, 100.09, 2.53,   0.04, 0.03,  -0.20, 0.01,  54.05, 0.02,"Average "},
	{ 2,   3.08, 1.67,-906.74, 8.66, -70.45, 0.99,   0.18, 0.01,  -0.56, 0.01,  -0.98, 0.02,"Average "},
	{ 3,-119.66, 2.00, -71.04,21.55,-548.02, 1.25,   0.02, 0.01,   0.07, 0.01,   2.92, 0.02,"Average "},
	{ 4,-240.70, 1.31,-356.87, 8.17, -52.84, 0.90,   1.48, 0.01,   0.26, 0.00,   0.29, 0.01,"Average "},
	{ 5,-397.55,10.09,-690.69,35.74,-608.06, 4.02,   0.31, 0.02,   0.50, 0.02,  -3.05, 0.04,"Average "},
	{ 6, 266.30, 3.63, 447.43,10.31, 209.63, 1.40,  -0.39, 0.01,  -0.04, 0.01,  -1.51, 0.03,"Average "},
	{ 7,  79.76,99.99,-219.43,99.99,-209.81,99.99,   0.04, 0.71,  -0.11, 1.10,  -0.11, 2.52,"Average "},
	{ 8,-403.61, 1.01,1022.85, 5.07, -96.94, 2.62,  -0.59, 0.01,  -0.08, 0.00,   0.83, 0.02,"Average "},
	{ 9,-113.41, 4.29,-482.73,18.37,-175.61, 3.25,   0.34, 0.02,   0.66, 0.01, -34.29, 0.06,"Average "},
	{10,1270.03,99.99,-2709.44,99.99,1730.72,99.99,  -1.75, 0.45,   0.84, 0.46,   2.04, 1.77,"Average "},
	{11,1081.64,99.99, 157.83,99.99,-980.13,99.99,   0.94, 0.52,   0.62, 0.80,   1.06, 1.24,"Average "},
	{12,2253.44,79.19,-1561.99,99.99, 275.94, 5.00,  -0.33, 0.09,   0.42, 0.08, -40.48, 0.05,"Average "},
	{13, 118.18,22.37,-1197.43,99.99, 182.04, 1.48,   0.01, 0.12,   0.29, 0.12, -61.91, 0.03,"Average "},
	{14,  59.08,36.91,-116.78,99.99, 438.97,40.53,  -0.63, 0.05,   0.27, 0.03,   0.93, 0.08,"Average "},
	{15,8094.98,99.99,-7090.50,99.99,-128.28,33.82,   1.36, 0.19,   1.02, 0.10,  -0.03, 0.14,"Average "},
	{16, 247.44, 1.02, 180.19, 6.26,-675.13, 0.63,  -0.26, 0.01,  -0.22, 0.00,  -2.50, 0.01,"Average "},
	{17, 371.44, 8.53,-970.53,99.99,-233.80, 3.02,  -0.38, 0.03,  -0.06, 0.01,  12.55, 0.40,"Average "},
	{18, 353.39, 1.27,-1035.69,11.83,-338.65, 1.48,   0.45, 0.01,   0.08, 0.00,  -0.24, 0.02,"Average "},
	{19,-2612.45,99.99, 785.85,99.99,-106.19,35.86,   0.57, 0.42,   0.46, 0.17, -19.99, 0.43,"Average "},
	{20, -85.64, 0.50, 351.85, 2.94, -80.79, 0.44,   0.10, 0.00,   0.00, 0.00,  -1.60, 0.01,"Average "},
	{21, -66.63,99.99,1764.34,99.99,-423.63,56.90,   3.29, 1.19,  -0.06, 0.61, 320.04, 0.61,"Average "},
	{22, 212.14, 0.84,  54.92, 5.55, 130.94, 0.68,  -0.18, 0.01,   0.11, 0.00,  -0.31, 0.03,"Average "},
	{23, -65.99,99.99, 839.78,99.99, -64.97,99.99,   0.34, 0.54,  -0.61, 0.65,  -0.82, 1.74,"Average "},
	{24, 171.97, 0.93,-334.39, 8.89,-209.46, 1.23,   0.10, 0.01,  -0.19, 0.00,   0.73, 0.02,"Average "},
    }
  },
  {20210303,  103, "ZF", // 
      {
	{ 1,-5242.36,99.99,1920.24,99.99,   3.37,16.20,   0.45, 0.28,   0.07, 0.23,  -0.16, 0.15,"Average "},
	{ 2,-284.30, 5.29,-601.73, 9.41,  52.01, 0.87,   0.36, 0.01,  -0.09, 0.00,  -0.45, 0.03,"Average "},
	{ 3,-3450.21,99.99,-296.20,99.99,-897.78,15.57,   2.58, 0.89,   0.70, 0.74,   0.51, 0.43,"Average "},
	{ 4,  27.15, 2.46, 378.99, 8.07,  72.22, 1.24,  -0.53, 0.01,  -0.02, 0.00,   0.66, 0.01,"Average "},
	{ 5,1887.96,99.99,-1344.08,99.99, 558.55,99.99,  -0.41, 0.36,  -2.09, 0.82,  -0.52, 1.56,"Average "},
	{ 6, 903.80,28.35,-7692.30,66.86, 813.56, 2.11,   0.85, 0.03,   2.62, 0.01,   5.11, 0.06,"Average "},
	{ 7,-998.48,99.99,-630.40,99.99, 199.96, 6.00,  -2.30, 0.14,  -0.09, 0.31,  -0.12, 0.16,"Average "},
	{ 8, 196.11, 1.62,-2534.60, 6.93,-325.60, 0.47,   1.81, 0.01,   0.54, 0.00,   0.46, 0.02,"Average "},
	{ 9, -21.47,17.31,  93.01,63.39,-208.30, 5.70,  -0.39, 0.04,   0.28, 0.03,-240.58, 0.09,"Average "},
	{10,6580.53,99.99,-2973.74,99.99, 549.13,99.99,  -0.53, 0.44,   0.83, 0.61,   3.68, 0.97,"Average "},
	{11,2489.84,99.99, 367.97,99.99,-866.44,99.99,   0.88, 0.41,  -0.55, 0.56,   1.65, 1.28,"Average "},
	{12,2939.48,99.99, 340.22,99.99,  67.41,99.99,  -0.30, 0.35,  -0.33, 0.55,   2.00, 1.20,"Average "},
	{13,-608.71,76.99,-461.44,99.99, 206.31, 1.96,   0.33, 0.16,   0.15, 0.23,-201.91, 0.06,"Average "},
	{14,2355.16,27.44,-6013.26,62.77,-235.53, 7.85,   1.56, 0.02,  -1.36, 0.05,  -2.10, 0.08,"Average "},
	{15,-412.09,99.99,-1777.33,99.99,-205.07,99.99,  -0.38, 0.82,  -1.05, 1.17,  -0.68, 3.60,"Average "},
	{16,  45.01, 1.72,-939.88, 9.03,-695.70, 0.64,   0.62, 0.01,  -0.42, 0.00,  -0.48, 0.02,"Average "},
	{17,1445.84,99.99,-1654.81,99.99,-492.10,22.69,   2.98, 0.38,  -0.27, 0.52, 506.14, 0.13,"Average "},
	{18,-248.18, 8.50,-916.12,99.99,-437.72, 3.93,  -0.32, 0.01,   0.28, 0.03,  -3.04, 0.02,"Average "},
	{19,-467.11,99.99,-690.43,99.99,-196.26,99.99,   0.15, 0.46,  -0.54, 0.67,  -1.64, 1.31,"Average "},
	{20, -81.26, 0.83,-960.49, 3.69,   7.23, 0.44,   1.15, 0.00,  -0.03, 0.00,   0.31, 0.01,"Average "},
	{21,-7607.34,99.99, 165.57,99.99,-450.99,99.99,   0.09, 0.83,  -0.63, 1.24,  -6.10, 3.33,"Average "},
	{22, 443.33, 4.31,-569.62,10.08,  62.83, 0.59,   1.34, 0.02,  -0.10, 0.00,  -0.15, 0.04,"Average "},
	{23,2908.87,99.99,-151.92,99.99, 107.53,99.99,  -0.12, 0.52,   1.39, 0.78,   4.01, 1.71,"Average "},
	{24,  53.83, 1.86,1235.71,21.89,-133.58, 1.29,  -0.30, 0.01,   0.05, 0.00,   0.65, 0.02,"Average "},
    }
  },
  {20210303,  102, "RHF", // 
      {
	{ 1,-219.97,42.70,-291.61,99.99,  35.50,15.38,   0.12, 0.27,  -0.04, 0.27,  -0.04, 0.11,"Average "},
	{ 2, 122.35, 1.46,-747.26,14.16, -37.59, 1.10,   0.29, 0.01,   0.25, 0.01,  -1.22, 0.04,"Average "},
	{ 3, -86.34,11.29,-403.93,67.62,-767.36, 2.62,   0.28, 0.03,   0.50, 0.02,  -1.51, 0.05,"Average "},
	{ 4,  46.17, 4.29, 174.23, 9.68,  35.40, 0.71,  -0.55, 0.01,  -0.04, 0.00,  -0.13, 0.01,"Average "},
	{ 5,-5333.79,99.99,-609.42,99.99,-927.05,14.35,   9.53, 0.49,   0.77, 0.15,  57.08, 0.43,"Average "},
	{ 6, 825.63,10.78,-1873.51,43.30, 263.21, 9.10,  -0.09, 0.04,  -0.69, 0.01,  -2.24, 0.09,"Average "},
	{ 7,-3231.19,99.99,2641.53,99.99,  87.33,18.35,   1.38, 0.30,   0.00, 0.61,  -0.24, 0.29,"Average "},
	{ 8,-648.31, 1.72,-2453.61, 5.82,-161.55, 0.61,   2.13, 0.01,   0.23, 0.00,   2.75, 0.02,"Average "},
	{ 9,-2056.02,99.99,-2714.97,99.99,-251.75,16.88,  -0.92, 0.12,   0.94, 0.23,-189.68, 0.15,"Average "},
	{10,-7191.58,99.99, 996.53,99.99,-863.68,99.99,   0.10, 0.69,   3.15, 0.99,  -3.89, 2.88,"Average "},
	{11,-1401.23,99.99, 163.40,99.99, 424.40,99.99,  -0.22, 0.85,   0.41, 1.39,  -0.62, 3.02,"Average "},
	{12,-501.15,13.92, 991.10,99.99,-251.58, 3.67,   0.20, 0.03,  -0.12, 0.25,  -1.10, 0.04,"Average "},
	{13, 342.57,95.88,1439.80,99.99,  78.18, 3.55,   0.23, 0.28,  -0.00, 0.36,-109.01, 0.10,"Average "},
	{14,1521.69,13.56,-4534.50,59.59,  39.49, 8.93,   0.24, 0.02,   2.08, 0.04,   0.41, 0.06,"Average "},
	{15,11701.85,99.99,-11318.74,99.99,-291.85,29.07,  -0.70, 0.25,  -0.52, 0.54,   0.43, 0.27,"Average "},
	{16,  78.74, 2.62, 145.37, 9.04,-797.09, 0.87,  -0.24, 0.01,  -0.22, 0.00,   0.73, 0.02,"Average "},
	{17,2638.10,99.99,-957.34,99.99,-753.88,24.11,   0.24, 0.43,  -0.45, 0.38, 312.79, 0.16,"Average "},
	{18, -36.81, 5.57,-2094.53,54.93,-480.31, 3.59,  -0.39, 0.01,  -0.29, 0.00,   0.42, 0.03,"Average "},
	{19,7270.27,99.99,-1828.19,99.99,1011.46,99.99,  -1.23, 0.78,  -0.68, 1.39,   3.47, 2.51,"Average "},
	{20,-145.95, 0.66,-192.91, 3.60,-119.14, 0.58,   0.45, 0.00,   0.06, 0.00,   1.59, 0.01,"Average "},
	{21,-10913.99,99.99,1617.78,99.99, 361.77,99.99,  -0.55, 1.55,  -0.64, 1.79,  -8.76, 6.52,"Average "},
	{22,  94.56, 3.62,-298.44, 9.02, 127.03, 0.89,   0.84, 0.02,  -0.16, 0.00,   2.10, 0.04,"Average "},
	{23,1272.23,99.99,-711.30,99.99, 639.55,99.99,  -0.39, 0.67,  -1.15, 1.36,   0.58, 2.12,"Average "},
	{24,-106.43, 2.71, 253.66,14.44,  16.95, 1.02,   0.05, 0.01,  -0.12, 0.00,   0.38, 0.02,"Average "},
    }
  },
  {20210303,  105, "FHF", // 
      {
	{ 1, 611.44, 1.99, 220.79,14.73, 360.82, 2.17,  -0.37, 0.03,  -0.33, 0.01, 113.91, 0.04,"Average "},
	{ 2,-142.02, 1.28,-215.63, 8.39, -13.33, 1.43,   0.33, 0.01,  -0.03, 0.00,   0.60, 0.02,"Average "},
	{ 3,  10.11, 6.84,1194.84,54.62,-645.09, 2.15,  -0.58, 0.03,   0.42, 0.02,   0.50, 0.04,"Average "},
	{ 4,-304.19, 1.06, 842.29, 6.78,  32.55, 0.70,  -0.74, 0.01,   0.02, 0.00,  -0.33, 0.01,"Average "},
	{ 5, 856.66,99.99,-1148.82,99.99,-708.60,10.34,   1.20, 0.25,   0.10, 0.07,  33.12, 0.20,"Average "},
	{ 6, 345.52, 4.73, 693.31,16.81, 370.21, 1.38,  -0.32, 0.01,   0.35, 0.01,   1.26, 0.02,"Average "},
	{ 7,-1717.69,99.99, 134.07,99.99,  98.54,11.77,   1.03, 0.18,  -0.30, 0.33,  -0.11, 0.15,"Average "},
	{ 8,-196.26, 2.76,-444.84, 7.24,-164.92, 0.78,  -0.51, 0.01,  -0.06, 0.00,   2.13, 0.02,"Average "},
	{ 9, 107.32, 6.51,-586.60,17.57, 111.23, 3.22,   0.47, 0.01,   0.46, 0.01,  -2.16, 0.05,"Average "},
	{10, 367.53,51.20,-524.19,88.05, 103.67, 8.20,   0.65, 0.08,   0.32, 0.07,   1.30, 0.24,"Average "},
	{11,13344.70,99.99,1571.51,99.99, 263.47,13.58,   1.96, 0.22,   0.17, 0.08,   0.50, 0.32,"Average "},
	{12, -15.31, 3.67, 340.78,21.10,  42.75, 4.89,  -0.29, 0.01,  -0.13, 0.01,   1.27, 0.04,"Average "},
	{13, 251.83,69.52,2019.42,99.99, 151.69, 2.38,   0.21, 0.20,   0.07, 0.26,-108.20, 0.06,"Average "},
	{14,1416.48,16.49,-4207.73,80.97, 134.53, 3.52,   0.15, 0.02,   2.32, 0.05,  -1.07, 0.06,"Average "},
	{15,8442.79,99.99,-7286.52,99.99,-216.99,54.99,  -2.47, 0.35,   0.75, 0.56,   0.65, 0.58,"Average "},
	{16, 216.19, 1.00,-210.07, 8.86,-719.39, 0.89,  -0.23, 0.01,  -0.05, 0.00,  -1.36, 0.02,"Average "},
	{17, 984.42,99.99,-354.56,99.99,-352.62,11.64,   0.05, 0.29,  -0.24, 0.26, 145.39, 0.08,"Average "},
	{18, 418.59, 1.80,-1299.32,30.11,-491.62, 2.46,   0.02, 0.01,  -0.05, 0.00,  -0.47, 0.02,"Average "},
	{19, 190.44,10.08,-340.09,78.38, 206.59, 4.14,   0.17, 0.04,  -0.02, 0.03, -13.63, 0.08,"Average "},
	{20,-122.70, 0.54, 417.76, 3.48, -38.78, 0.50,  -0.00, 0.01,   0.02, 0.00,  -1.77, 0.01,"Average "},
	{21, 150.52, 7.63,1208.98,59.53, 319.06, 3.51,  -0.59, 0.03,  -0.57, 0.02,  -0.50, 0.06,"Average "},
	{22,  90.42, 3.57,-109.83, 7.96, 112.02, 0.66,   0.06, 0.01,  -0.17, 0.00,  -0.93, 0.02,"Average "},
	{23,-2480.63,99.99,-937.27,99.99, 866.32,99.99,  -0.26, 0.91,  -0.03, 1.85,  -2.76, 3.15,"Average "},
	{24, 142.34, 2.61, -77.67,28.14, 125.36, 3.84,  -0.15, 0.01,   0.06, 0.00,   0.07, 0.02,"Average "},
    }
  }
};
const  Int_t NP = sizeof(Passes)/sizeof(SurveyPass_t);
TCanvas *c1 = 0;
THStack *hs[6];
TLegend *leg[6];
//________________________________________________________________________________
void ResultsL(const Char_t *opt="") {
  gStyle->SetMarkerStyle(20);
  gStyle->SetOptStat(0);
  cout << "NP \t" << NP << endl;
  Int_t NH = NP;
  if (NH == 2) NH++; // make average if we have only FF + RF
  TH1D ***dath = new TH1D**[NH]; 
  for (Int_t p = 0; p < NH; p++) {dath[p] = new TH1D*[6]; memset(dath[p],0, 6*sizeof(TH1D*));}
  const Char_t *names[6] = {" #Deltax"," #Deltay"," #Deltaz"," #Delta #alpha"," #Delta #beta"," #Delta #gamma"};
  const Char_t *nameK[6] = {"Dx","Dy","Dz","Da",     "Db",    "Dg"};
  TString Opt(opt);
  for (Int_t i = 0; i < 6; i++) {
    hs[i] = new THStack(nameK[i],names[i]);
    Double_t ymin =  1e10;
    Double_t ymax = -1e10;
    TString Name;
    TString Title;
    if (! i)     leg[i] = new TLegend(0.10,0.65,0.30,0.90);
    else         leg[i] = 0;
    TString same("e");
    Int_t color = 1;
    TH1::SetDefaultSumw2(kTRUE);
    for (Int_t k = 0; k < NH; k++) {
      if (k < NP) {
	if (i == 0 && k < NP) Passes[k].Print();
	Name = Form("%s%s",Passes[k].PassName,nameK[i]);
	if (Opt != "" && ! Name.Contains(Opt,TString::kIgnoreCase)) continue;
	Title = Form("Alignment fit for  %s %s",names[i],Passes[k].PassName);
      } else { // Average
	Name = Form("%s%s%s",Passes[0].PassName,Passes[1].PassName,nameK[i]);
	if (Opt != "" && ! Name.Contains(Opt,TString::kIgnoreCase)) continue;
	Title = Form("Alignment fit for %s sum %s %s",names[i],Passes[0].PassName,Passes[1].PassName);
	
      }
      //      cout << Name.Data() << "\t" << Title.Data() << "\ti\t" << i << "\tk\t" << k << endl;
      dath[k][i] = (TH1D *) gDirectory->Get(Name);
      if (dath[k][i]) delete dath[k][i];
      
      dath[k][i] = new TH1D(Name,Title, 24, 0.5, 24.5);
      //      cout << "Create: " << dath[k][i]->GetName() << "\t" << dath[k][i]->GetTitle() << endl;
      dath[k][i]->SetMarkerColor(color);
      dath[k][i]->SetLineColor(color);
      color++;
      dath[k][i]->SetXTitle("sector");
      if (i < 3) dath[k][i]->SetYTitle(Form("%s (#mum)",names[i]));
      else       dath[k][i]->SetYTitle(Form("%s (mrad)",names[i]));
      for (Int_t l = 0; l < 24; l++) {
	Int_t secs;
	Double_t val, err;
	if (k < NP) {
	  Double_t *X = &Passes[k].Data[l].x;
	  secs = Passes[k].Data[l].sector;
	  if (X[2*i+1] >= 0 && X[2*i+1] < 99) {
	    val = X[2*i];
	    err = X[2*i+1];
	  } else {continue;}
	} else {
	  Double_t *X0 = &Passes[0].Data[l].x;
	  Double_t *X1 = &Passes[1].Data[l].x;
	  secs = Passes[0].Data[l].sector;
	  if (X0[2*i+1] >= 0 && X0[2*i+1] < 99 &&
	      X1[2*i+1] >= 0 && X1[2*i+1] < 99) {
	    val = 0.5*(X0[2*i] + X1[2*i]);
	    dath[k][i]->SetBinContent(secs,val);
	    err = TMath::Sqrt(X0[2*i+1]*X0[2*i+1]+X1[2*i+1]*X1[2*i+1])/2;
	  } else {continue;}
	} 
	if (err < 0.001) err = 0.001;
	dath[k][i]->SetBinContent(secs,val);
	dath[k][i]->SetBinError(secs,err);
	if (ymin > val - err) ymin = val - err;
	if (ymax < val + err) ymax = val + err;
      }
      hs[i]->Add(dath[k][i]);
      if (leg[i]) {
	if (k < NP) leg[i]->AddEntry(dath[k][i],Passes[k].PassName);
	else        leg[i]->AddEntry(dath[k][i],"sum");
      }
    }
  }
  c1 = new TCanvas("IO","Tpc Outer to Inner alignment parameters",1200,800);
  c1->Divide(3,2);
  for (Int_t i = 0; i < 6; i++) {
    c1->cd(i+1);
    if (! hs[i]) continue;
    TString same("e");
    Double_t ymax = hs[i]->GetMaximum("nostack");
    Double_t ymin = hs[i]->GetMinimum("nostack");
    TList *list = hs[i]->GetHists();
    TIter next(list);
    TH1 *h = 0;
    while ((h = (TH1*) next())) {
      h->GetYaxis()->SetTitleOffset(1.4);
      if (same == "e") {
	if (ymax > 0)     h->SetMaximum(1.1*ymax);
	else              h->SetMaximum(0.9*ymax);
	if (ymin < 0)     h->SetMinimum(1.1*ymin);
	else              h->SetMinimum(0.9*ymin);
      }
      TString hName(h->GetName());
      if (hName.BeginsWith("db",TString::kIgnoreCase)) h->Draw("same");
      else                                             h->Draw(same);
      same = "same";
    }
    if (leg[i]) leg[i]->Draw();
  }
  c1->Update();
}
